<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seattle EcoSort Challenge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            z-index: 10;
            padding: 0.5rem;
        }

        /* Background styles */
        .background {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }

        .background.level-1 {
            background: linear-gradient(180deg, 
                #87CEEB 0%, 
                #87CEEB 25%, 
                #B0E0E6 25%, 
                #B0E0E6 50%, 
                #98FB98 50%, 
                #98FB98 75%, 
                #228B22 75%, 
                #228B22 100%
            );
            image-rendering: pixelated;
        }

        .background.level-2 {
            background: linear-gradient(180deg, 
                #87CEEB 0%, 
                #87CEEB 40%, 
                #4682B4 40%, 
                #4682B4 65%, 
                #F4A460 65%, 
                #F4A460 85%, 
                #D2B48C 85%, 
                #D2B48C 100%
            );
            image-rendering: pixelated;
        }

        .background.level-3 {
            background: linear-gradient(180deg, 
                #87CEEB 0%, 
                #87CEEB 30%, 
                #B0E0E6 30%, 
                #B0E0E6 60%, 
                #E0F6FF 60%, 
                #E0F6FF 100%
            );
            image-rendering: pixelated;
        }

        /* Card styles */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Banner */
        .banner {
            background: rgba(30, 64, 175, 0.9);
            color: white;
            text-align: center;
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            border: 2px solid #1e40af;
        }

        .banner h1 {
            font-size: 1rem;
            font-weight: 600;
        }

        .banner p {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: bold;
            color: #374151;
            margin-bottom: 0.25rem;
        }

        .header p {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .location-message {
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            border: 2px solid;
            display: inline-block;
            font-weight: 600;
            font-size: 0.75rem;
        }

        .location-message.level-1 {
            background: rgba(251, 191, 36, 0.9);
            border-color: #eab308;
            color: #92400e;
        }

        .location-message.level-2 {
            background: rgba(96, 165, 250, 0.9);
            border-color: #3b82f6;
            color: #1e3a8a;
        }

        .location-message.level-3 {
            background: rgba(74, 222, 128, 0.9);
            border-color: #22c55e;
            color: #14532d;
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0.25rem;
            padding: 0.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-icon {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .stat-value {
            font-size: 1rem;
            font-weight: bold;
            color: #374151;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #6b7280;
        }

        /* Current Item */
        .current-item {
            text-align: center;
            margin-bottom: 1rem;
            margin-top: 1rem;
            position: relative;
            z-index: 20;
        }

        .item-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            display: inline-block;
            border: 3px solid #3b82f6;
            max-width: 300px;
        }

        .item-card h2 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #374151;
        }

        .item-image {
            width: 6rem;
            height: 6rem;
            margin: 0 auto 1rem;
            border-radius: 0.5rem;
            border: 2px solid #e5e7eb;
            background: linear-gradient(to bottom right, #f9fafb, #f3f4f6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: move;
            user-select: none;
            transition: transform 0.2s;
            padding: 0.25rem;
        }

        .item-image svg {
            max-width: 100%;
            max-height: 100%;
            pointer-events: none;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
        }

        .item-image:hover {
            transform: scale(1.1);
        }

        .item-name {
            font-size: 1.125rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .item-instruction {
            font-size: 0.875rem;
            color: #6b7280;
        }

        /* Bins */
        .bins {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
            grid-template-columns: repeat(4, 1fr);
            min-height: 70vh;
        }

        @media (max-width: 768px) {
            .bins {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .bins {
                grid-template-columns: 1fr;
            }
        }

        .bin {
            border-radius: 2rem;
            padding: 2rem;
            color: #374151;
            text-align: center;
            width: 95%;
            height: 70vh;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(4px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .bin:hover {
            transform: scale(1.01);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .bin-icon {
            font-size: 12rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 70%;
            width: 90%;
        }

        .bin-icon svg {
            width: 100%;
            height: 100%;
            max-width: none;
            max-height: none;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .bin-title {
            font-size: clamp(2rem, 5vw, 6rem);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .bin-subtitle {
            font-size: clamp(1.5rem, 3vw, 4rem);
            opacity: 0.8;
        }

        .bin-icon svg {
            max-width: 100%;
            max-height: 100%;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .bin-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .bin-subtitle {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Modal */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            max-width: 32rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: #6b7280;
        }

        .lesson-content {
            margin-bottom: 1.5rem;
        }

        .lesson-item {
            background: #dbeafe;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .lesson-bin {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .lesson-description {
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .lesson-tip {
            font-size: 0.875rem;
            color: #1d4ed8;
            font-weight: 500;
        }

        .lesson-warning {
            background: #fef2f2;
            border-left: 4px solid #f87171;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .warning-title {
            font-weight: 600;
            color: #991b1b;
            margin-bottom: 0.25rem;
        }

        .warning-text {
            color: #b91c1c;
            font-size: 0.875rem;
        }

        .modal-buttons {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #16a34a;
            color: white;
        }

        .btn-primary:hover {
            background: #15803d;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        /* Feedback */
        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            z-index: 50;
            text-align: center;
            max-width: 28rem;
            color: white;
        }

        .feedback.success {
            background: #16a34a;
        }

        .feedback.error {
            background: #dc2626;
        }

        .feedback-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.75rem;
        }

        .feedback-icon {
            font-size: 2rem;
            margin-right: 0.5rem;
        }

        .feedback-title {
            font-size: 1.25rem;
            font-weight: bold;
        }

        .feedback-message {
            margin-bottom: 0.75rem;
        }

        .feedback-points {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .level-up {
            font-size: 1.125rem;
            font-weight: bold;
            margin-top: 0.5rem;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Reset button */
        .reset-container {
            text-align: center;
            margin-bottom: 1rem;
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 20;
        }

        .btn-reset {
            background: #7c3aed;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-reset:hover {
            background: #6d28d9;
        }

        /* Drag over effect */
        .bin.drag-over {
            background: rgba(255, 255, 255, 0.2) !important;
            transform: scale(1.1) !important;
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Simple info boxes */
        .info-box {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.25rem;
            border-left: 4px solid;
        }

        .info-box.green {
            background: #f0fdf4;
            border-color: #16a34a;
        }

        .info-box.yellow {
            background: #fefce8;
            border-color: #eab308;
        }

        .info-box.red {
            background: #fef2f2;
            border-color: #dc2626;
        }

        .info-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .info-title.green {
            color: #166534;
        }

        .info-title.yellow {
            color: #a16207;
        }

        .info-title.red {
            color: #991b1b;
        }

        .info-text {
            font-size: 0.875rem;
        }

        .info-text.green {
            color: #166534;
        }

        .info-text.yellow {
            color: #a16207;
        }

        .info-text.red {
            color: #b91c1c;
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div id="background" class="background level-1">
        <svg id="background-svg" style="position: absolute; inset: 0; width: 100%; height: 100%; opacity: 0.6;" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice">
            <!-- Background content will be generated by JavaScript -->
        </svg>
    </div>

    <div class="container">
        <!-- Banner -->
        <div class="banner">
            <h1>🏔️ Seattle EcoSort Challenge</h1>
            <p>This game reflects waste sorting rules specific to Seattle, WA</p>
        </div>

        <!-- Header -->
        <div class="header">
            <h1>Seattle EcoSort Challenge 🌱</h1>
            <p>Learn Seattle's waste sorting rules and help keep our city green!</p>
            <div id="location-message" class="location-message level-1">
                🏭 Gas Works Park needs your help! Sort the scattered waste correctly to clean up this iconic Seattle landmark! 🧹
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-icon">🏆</div>
                <div id="score" class="stat-value">0</div>
                <div class="stat-label">Score</div>
            </div>
            <div class="stat-card">
                <div id="streak" class="stat-value" style="color: #f97316;">0</div>
                <div class="stat-label">Streak</div>
            </div>
            <div class="stat-card">
                <div id="level" class="stat-value" style="color: #8b5cf6;">1</div>
                <div class="stat-label">Level</div>
            </div>
            <div class="stat-card">
                <div id="items-completed" class="stat-value" style="color: #10b981;">0</div>
                <div class="stat-label">Items Sorted</div>
            </div>
        </div>

        <!-- Current Item -->
        <div id="current-item-container" class="current-item hidden">
            <div class="item-card">
                <h2 style="font-size: 1rem; font-weight: 600; margin-bottom: 1rem; color: #374151;">
                    Sort this item according to Seattle rules:
                </h2>
                <div id="current-item" class="item-image" draggable="true"></div>
                <div id="item-name" class="item-name"></div>
                <div class="item-instruction">
                    👆 Click and drag the image to the correct bin below ⬇️
                </div>
            </div>
        </div>

        <!-- Bins -->
        <div class="bins">
            <div class="bin garbage" data-type="garbage">
                <div class="bin-icon">
                    <svg width="80" height="80" viewBox="0 0 120 250">
                        <!-- Bin Body -->
                        <rect x="0" y="40" width="120" height="180" rx="8" fill="#2c2c2c" stroke="#1a1a1a" stroke-width="2"/>
                        <!-- Lid -->
                        <ellipse cx="60" cy="45" rx="65" ry="15" fill="#1a1a1a"/>
                        <ellipse cx="60" cy="40" rx="65" ry="15" fill="#2c2c2c" stroke="#1a1a1a" stroke-width="2"/>
                        <!-- Handle -->
                        <rect x="45" y="30" width="30" height="8" rx="4" fill="#666"/>
                        <!-- Wheels -->
                        <circle cx="25" cy="235" r="12" fill="#333" stroke="#1a1a1a" stroke-width="1"/>
                        <circle cx="95" cy="235" r="12" fill="#333" stroke="#1a1a1a" stroke-width="1"/>
                        <!-- Label -->
                        <rect x="20" y="100" width="80" height="40" rx="4" fill="white"/>
                        <text x="60" y="115" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">GARBAGE</text>
                        <text x="60" y="130" text-anchor="middle" font-size="8" fill="#666">General Waste</text>
                    </svg>
                </div>
                <div class="bin-title">Garbage</div>
                <div class="bin-subtitle">Non-recyclable waste</div>
            </div>
            <div class="bin recycling" data-type="recycling">
                <div class="bin-icon">
                    <svg width="80" height="80" viewBox="0 0 120 250">
                        <!-- Bin Body -->
                        <rect x="0" y="40" width="120" height="180" rx="8" fill="#1e5aa8" stroke="#0f3d75" stroke-width="2"/>
                        <!-- Lid -->
                        <ellipse cx="60" cy="45" rx="65" ry="15" fill="#0f3d75"/>
                        <ellipse cx="60" cy="40" rx="65" ry="15" fill="#1e5aa8" stroke="#0f3d75" stroke-width="2"/>
                        <!-- Handle -->
                        <rect x="45" y="30" width="30" height="8" rx="4" fill="#4a7bc8"/>
                        <!-- Wheels -->
                        <circle cx="25" cy="235" r="12" fill="#0f3d75" stroke="#082654" stroke-width="1"/>
                        <circle cx="95" cy="235" r="12" fill="#0f3d75" stroke="#082654" stroke-width="1"/>
                        <!-- Recycling Symbol -->
                        <g transform="translate(60, 120) scale(0.8)">
                            <path d="M-15,-10 L-5,-25 L5,-25 L15,-10 L5,5 L-5,5 Z" fill="white" opacity="0.9"/>
                            <text x="0" y="0" text-anchor="middle" font-size="12" font-weight="bold" fill="#1e5aa8">♻</text>
                        </g>
                        <!-- Label -->
                        <rect x="20" y="150" width="80" height="40" rx="4" fill="white"/>
                        <text x="60" y="165" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">RECYCLING</text>
                        <text x="60" y="180" text-anchor="middle" font-size="8" fill="#666">Clean & Dry</text>
                    </svg>
                </div>
                <div class="bin-title">Recycling</div>
                <div class="bin-subtitle">Clean recyclables</div>
            </div>
            <div class="bin compost" data-type="compost">
                <div class="bin-icon">
                    <svg width="80" height="80" viewBox="0 0 120 250">
                        <!-- Bin Body -->
                        <rect x="0" y="40" width="120" height="180" rx="8" fill="#2d5d31" stroke="#1a3d1e" stroke-width="2"/>
                        <!-- Lid -->
                        <ellipse cx="60" cy="45" rx="65" ry="15" fill="#1a3d1e"/>
                        <ellipse cx="60" cy="40" rx="65" ry="15" fill="#2d5d31" stroke="#1a3d1e" stroke-width="2"/>
                        <!-- Handle -->
                        <rect x="45" y="30" width="30" height="8" rx="4" fill="#4a7c4e"/>
                        <!-- Wheels -->
                        <circle cx="25" cy="235" r="12" fill="#1a3d1e" stroke="#0f2612" stroke-width="1"/>
                        <circle cx="95" cy="235" r="12" fill="#1a3d1e" stroke="#0f2612" stroke-width="1"/>
                        <!-- Compost Symbol (leaf) -->
                        <g transform="translate(60, 120)">
                            <path d="M0,-15 C-10,-10 -15,0 -10,10 C-5,15 5,15 10,10 C15,0 10,-10 0,-15" fill="white" opacity="0.9"/>
                            <path d="M0,-15 C5,-12 8,-5 5,5" stroke="#2d5d31" stroke-width="2" fill="none"/>
                        </g>
                        <!-- Label -->
                        <rect x="20" y="150" width="80" height="40" rx="4" fill="white"/>
                        <text x="60" y="165" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">COMPOST</text>
                        <text x="60" y="180" text-anchor="middle" font-size="8" fill="#666">Food & Yard</text>
                    </svg>
                </div>
                <div class="bin-title">Food & Yard Waste</div>
                <div class="bin-subtitle">Organic materials</div>
            </div>
            <div class="bin hazardous" data-type="hazardous">
                <div class="bin-icon">
                    <svg width="80" height="80" viewBox="0 0 120 250">
                        <!-- Bin Body -->
                        <rect x="0" y="40" width="120" height="180" rx="8" fill="#dc2626" stroke="#b91c1c" stroke-width="2"/>
                        <!-- Lid -->
                        <ellipse cx="60" cy="45" rx="65" ry="15" fill="#b91c1c"/>
                        <ellipse cx="60" cy="40" rx="65" ry="15" fill="#dc2626" stroke="#b91c1c" stroke-width="2"/>
                        <!-- Handle -->
                        <rect x="45" y="30" width="30" height="8" rx="4" fill="#991b1b"/>
                        <!-- Wheels -->
                        <circle cx="25" cy="235" r="12" fill="#7f1d1d" stroke="#450a0a" stroke-width="1"/>
                        <circle cx="95" cy="235" r="12" fill="#7f1d1d" stroke="#450a0a" stroke-width="1"/>
                        
                        <!-- Main Hazard Symbol -->
                        <g transform="translate(60, 120)">
                            <circle r="20" fill="#fef2f2" stroke="#991b1b" stroke-width="2"/>
                            <text x="0" y="8" text-anchor="middle" font-size="24" fill="#dc2626">☢</text>
                        </g>
                        
                        <!-- Warning Symbols Row -->
                        <g transform="translate(20, 85)">
                            <!-- Toxic -->
                            <circle cx="0" cy="0" r="8" fill="#fef2f2" stroke="#991b1b" stroke-width="1"/>
                            <text x="0" y="3" text-anchor="middle" font-size="8" fill="#dc2626">☠</text>
                        </g>
                        <g transform="translate(100, 85)">
                            <!-- Flammable -->
                            <circle cx="0" cy="0" r="8" fill="#fef2f2" stroke="#991b1b" stroke-width="1"/>
                            <text x="0" y="3" text-anchor="middle" font-size="8" fill="#dc2626">🔥</text>
                        </g>
                        <g transform="translate(20, 155)">
                            <!-- Corrosive -->
                            <circle cx="0" cy="0" r="8" fill="#fef2f2" stroke="#991b1b" stroke-width="1"/>
                            <text x="0" y="3" text-anchor="middle" font-size="8" fill="#dc2626">⚗</text>
                        </g>
                        <g transform="translate(100, 155)">
                            <!-- Explosive -->
                            <circle cx="0" cy="0" r="8" fill="#fef2f2" stroke="#991b1b" stroke-width="1"/>
                            <text x="0" y="3" text-anchor="middle" font-size="8" fill="#dc2626">💥</text>
                        </g>
                        
                        <!-- Label -->
                        <rect x="15" y="180" width="90" height="35" rx="4" fill="#fef2f2"/>
                        <text x="60" y="192" text-anchor="middle" font-size="8" font-weight="bold" fill="#dc2626">⚠ HAZARDOUS ⚠</text>
                        <text x="60" y="202" text-anchor="middle" font-size="7" font-weight="bold" fill="#dc2626">WASTE</text>
                        <text x="60" y="212" text-anchor="middle" font-size="6" fill="#991b1b">Special Handling</text>
                    </svg>
                </div>
                <div class="bin-title">Hazardous Waste</div>
                <div class="bin-subtitle">Special handling required</div>
            </div>
        </div>

        <!-- Reset Button -->
        <div class="reset-container">
            <button id="reset-btn" class="btn btn-reset">
                🔄 Reset Game
            </button>
        </div>
    </div>

    <!-- Modal (initially hidden) -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title" class="modal-title"></h2>
                <p id="modal-subtitle" class="modal-subtitle"></p>
            </div>
            <div id="modal-body" class="lesson-content"></div>
            <div class="modal-buttons">
                <button id="start-btn" class="btn btn-primary">Start Game!</button>
                <button id="skip-btn" class="btn btn-secondary hidden">Skip Lesson</button>
            </div>
        </div>
    </div>

    <!-- Feedback (initially hidden) -->
    <div id="feedback" class="feedback hidden">
        <div class="feedback-header">
            <div id="feedback-icon" class="feedback-icon"></div>
            <span id="feedback-title" class="feedback-title"></span>
        </div>
        <p id="feedback-message" class="feedback-message"></p>
        <p id="feedback-points" class="feedback-points hidden"></p>
        <p id="level-up" class="level-up hidden"></p>
        <div id="game-complete" class="hidden">
            <p style="font-size: 1.125rem; font-weight: bold; margin: 0.75rem 0;">
                Final Score: <span id="final-score"></span> points!
            </p>
            <button id="play-again-btn" class="btn" style="background: white; color: #16a34a;">
                Play Again! 🔄
            </button>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            score: 0,
            streak: 0,
            level: 1,
            itemsCompleted: 0,
            currentItem: null,
            completedItems: new Set(),
            wrongAnswers: new Set(),
            gameStarted: false,
            showingLesson: true,
            reviewMode: false,
            reviewItems: []
        };

        // Level lessons with environmental impact
        const levelLessons = {
            1: {
                title: "Level 1: Basic Sorting",
                subtitle: "Learn the four bins and easy items",
                location: "🏭 Gas Works Park Cleanup",
                impact: "Gas Works Park is built on a former gas plant site. Proper waste sorting here prevents soil contamination and keeps this unique 19-acre park safe for the 100,000+ annual visitors who come to see the iconic gasification towers and enjoy stunning city views!",
                content: [
                    {
                        bin: "♻️ Recycling (Blue Bin)",
                        description: "Clean containers only! Plastic bottles (#1-7), glass jars, aluminum cans, clean paper.",
                        tip: "🧼 Remember: Rinse out containers before recycling!"
                    },
                    {
                        bin: "🌱 Food & Yard Waste (Green Bin)", 
                        description: "All food scraps, fruit peels, vegetable trimmings. This becomes rich compost!",
                        tip: "🍎 Fun fact: Even moldy food goes here, not garbage!"
                    },
                    {
                        bin: "🗑️ Garbage (Black Bin)",
                        description: "Non-recyclable items like used tissues, broken items, contaminated materials.",
                        tip: "⚠️ When in doubt, garbage is often the safest choice."
                    },
                    {
                        bin: "☢️ Hazardous Waste (Red Bin)",
                        description: "Batteries, electronics, paint, chemicals, CFLs. Need special handling for safety.",
                        tip: "🚨 Never put hazardous items in regular bins—they can harm workers and environment!"
                    }
                ],
                commonMistakes: "Common mistake: Putting dirty containers in recycling instead of cleaning them first!",
                pointsHelp: "🏆 Every 10 points = 1 piece of litter removed from Gas Works Park's historic grounds!",
                haulerInfo: {
                    title: "🚛 Seattle Waste & Recycling Services",
                    description: "Seattle's waste collection is handled by these certified companies:",
                    companies: [
                        { name: "Waste Management (WM)", service: "Garbage & Recycling Collection", website: "wm.com" },
                        { name: "Recology", service: "Garbage & Recycling Collection", website: "recology.com" },
                        { name: "Cedar Grove", service: "Compost Processing", website: "cedar-grove.com" }
                    ]
                }
            },
            2: {
                title: "Level 2: Seattle-Specific Rules & Hazardous Items", 
                subtitle: "Learn what makes Seattle different + safety items",
                location: "🏖️ Lake Union Shoreline Protection",
                impact: "Lake Union drains into the Ship Canal, then Puget Sound, and finally the Pacific Ocean. Proper sorting here protects marine life including salmon returning to spawn, harbor seals, and endangered Southern Resident orcas that depend on clean waters!",
                content: [
                    {
                        bin: "🍕 Food-Soiled Paper → Compost!",
                        description: "Cedar Grove accepts food-soiled paper including greasy pizza boxes in compost.",
                        tip: "🌟 Food-soiled is OK for compost, but chemical-soiled paper goes to garbage!"
                    },
                    {
                        bin: "🔋 CFLs → Hazardous Waste!",
                        description: "Compact fluorescent bulbs contain mercury and need special disposal—$5 pickup or free drop-off.",
                        tip: "💡 Most light bulbs (LED, incandescent) go to garbage, but CFLs are hazardous!"
                    },
                    {
                        bin: "🥄 Steel Spoon → Consider Donating!",
                        description: "Metal cutlery is too small for recycling machines. Better to donate reusable items than dispose.",
                        tip: "♻️ Most steel spoons don't need disposal—donate to extend their life!"
                    },
                    {
                        bin: "📃 Multiple Options Available!",
                        description: "Some items like shredded paper can go in multiple bins—both compost AND garbage are acceptable.",
                        tip: "🌱 When multiple options exist, choose the most environmentally friendly option!"
                    }
                ],
                commonMistakes: "Common mistake: Assuming all similar items have the same rules—usage, contamination, and safety matter!",
                pointsHelp: "🌊 Every 10 points = 1 piece of debris prevented from entering Lake Union and harming marine life!",
                haulerInfo: {
                    title: "🚛 Seattle Waste & Recycling Services",
                    description: "Seattle's waste collection is handled by these certified companies:",
                    companies: [
                        { name: "Waste Management (WM)", service: "Garbage & Recycling Collection", website: "wm.com" },
                        { name: "Recology", service: "Garbage & Recycling Collection", website: "recology.com" },
                        { name: "Cedar Grove", service: "Compost Processing", website: "cedar-grove.com" }
                    ]
                }
            },
            3: {
                title: "Level 3: Complex Decisions & Hazardous Materials",
                subtitle: "Master the most challenging sorting decisions",
                location: "🏙️ Seattle Center Cultural District",
                impact: "Seattle Center hosts 12+ million visitors annually for festivals, sports, and arts events. Proper waste sorting here showcases Seattle's environmental leadership to the world and keeps our cultural heart beautiful for events like Bumbershoot and New Year's celebrations!",
                content: [
                    {
                        bin: "📱 Electronics → Hazardous Waste",
                        description: "Phones, computers contain toxic materials and valuable metals. Need certified e-waste recycling.",
                        tip: "🔋 Electronics often contain batteries too—double reason for hazardous waste!"
                    },
                    {
                        bin: "🎨 Paint & Chemicals → Hazardous Waste",
                        description: "Paint, cleaners, pesticides can contaminate groundwater. Never pour down drains.",
                        tip: "🌊 Protect Seattle's water—hazardous liquids need special treatment!"
                    },
                    {
                        bin: "🧢 Size Rules & Processing Limits",
                        description: "Bottle caps under 3\", wire hangers, shredded paper—size and processing matter.",
                        tip: "⚙️ Processing equipment has limitations—not everything that seems recyclable can be processed!"
                    }
                ],
                commonMistakes: "Common mistake: Assuming material type determines disposal—safety, contamination, and processing limitations matter more!",
                pointsHelp: "✨ Every 10 points = 1 area of Seattle Center kept pristine for millions of visitors to enjoy!",
                haulerInfo: {
                    title: "🚛 Seattle Waste & Recycling Services",
                    description: "Seattle's waste collection is handled by these certified companies:",
                    companies: [
                        { name: "Waste Management (WM)", service: "Garbage & Recycling Collection", website: "wm.com" },
                        { name: "Recology", service: "Garbage & Recycling Collection", website: "recology.com" },
                        { name: "Cedar Grove", service: "Compost Processing", website: "cedar-grove.com" }
                    ]
                }
            }
        };

        // Waste items data (simplified for HTML)
        const wasteItems = [
            // Level 1 - Basic items (14 items)
            { id: 1, name: 'Clean Plastic Water Bottle (#1-7)', type: 'recycling', emoji: '', level: 1, explanation: 'Correct! Clean plastic bottles go in recycling—just rinse first!', wrongExplanation: 'Oops! Clean plastic bottles go in recycling, not garbage or compost.' },
            { id: 2, name: 'Apple Core', type: 'compost', emoji: '🍎', level: 1, explanation: 'Correct! All fruit scraps become nutrient-rich compost in Seattle!', wrongExplanation: 'Oops! Food scraps like apple cores go in compost, not garbage or recycling.' },
            { id: 3, name: 'Used Tissue', type: 'garbage', emoji: '🤧', level: 1, explanation: 'Correct! Used tissues are contaminated—they always go to garbage.', wrongExplanation: 'Oops! Used tissues are contaminated and can\'t be recycled or composted.' },
            { id: 4, name: 'Clean Newspaper', type: 'recycling', emoji: '📰', level: 1, explanation: 'Correct! Clean paper gets recycled into new products!', wrongExplanation: 'Oops! Clean paper like newspapers goes in recycling.' },
            { id: 5, name: 'Aluminum Can', type: 'recycling', emoji: '🥫', level: 1, explanation: 'Correct! Aluminum cans are 100% recyclable and use 95% less energy than new cans!', wrongExplanation: 'Oops! Aluminum cans are super valuable for recycling—they\'re worth their weight in gold!' },
            { id: 6, name: 'Banana Peel', type: 'compost', emoji: '🍌', level: 1, explanation: 'Correct! Even brown, mushy fruit scraps make excellent compost!', wrongExplanation: 'Oops! All fruit peels go in compost, even if they look gross!' },
            { id: 7, name: 'Clean Glass Jar', type: 'recycling', emoji: '🫙', level: 1, explanation: 'Correct! Glass can be recycled infinitely—just remove the lid first!', wrongExplanation: 'Oops! Clean glass containers go in recycling—they can be recycled forever!' },
            { id: 8, name: 'Clean Aluminum Pie Plate', type: 'recycling', emoji: '', level: 1, explanation: 'Correct! Clean aluminum pie plates are recyclable!', wrongExplanation: 'Oops! Clean aluminum pie plates go in recycling.' },
            { id: 9, name: 'Milk Carton (Clean)', type: 'recycling', emoji: '', level: 1, explanation: 'Correct! Clean milk cartons are recyclable in Seattle!', wrongExplanation: 'Oops! Clean milk cartons go in recycling, not garbage or compost.' },
            { id: 10, name: 'Meat & Bones', type: 'compost', emoji: '🥩', level: 1, explanation: 'Correct! Meat and bones are compostable in Seattle\'s curbside program!', wrongExplanation: 'Oops! Meat and bones go in compost—freeze odorous items until collection day.' },
            { id: 11, name: 'Carbonless Paper', type: 'recycling', emoji: '📋', level: 1, explanation: 'Correct! Carbonless paper is recyclable!', wrongExplanation: 'Oops! Carbonless paper goes in recycling.' },
            { id: 12, name: 'Flowers (No Plastic)', type: 'compost', emoji: '🌺', level: 1, explanation: 'Correct! Flowers are compostable—just remove plastic ties and cellophane!', wrongExplanation: 'Oops! Flowers go in compost, but remove any plastic wrapping first.' },
            { id: 13, name: 'Paper Towel (Unused)', type: 'compost', emoji: '', level: 1, explanation: 'Correct! Clean paper towels can be composted!', wrongExplanation: 'Oops! Unused paper towels go in compost, not garbage or recycling.' },
            { id: 14, name: 'Envelope (Clean)', type: 'recycling', emoji: '✉️', level: 1, explanation: 'Correct! Clean envelopes are recyclable paper!', wrongExplanation: 'Oops! Clean paper envelopes go in recycling.' },
            { id: 47, name: 'Coffee Cup (Paper)', type: 'recycling', emoji: '☕', level: 1, explanation: 'Correct! Paper coffee cups are recyclable in Seattle—the plastic lining can be separated during processing!', wrongExplanation: 'Oops! Paper coffee cups go in recycling in Seattle, despite the plastic lining.' },
            { id: 48, name: 'Juice Box (No Straw)', type: 'recycling', emoji: '🧃', level: 1, explanation: 'Correct! Juice boxes are recyclable cartons—just remove the straw first!', wrongExplanation: 'Oops! Juice boxes go in recycling, but remove the straw which goes to garbage.' },
            
            // Level 2 - Medium items (14 items)
            { id: 15, name: 'Greasy Pizza Box', type: 'compost', emoji: '', level: 2, explanation: 'Correct! Seattle\'s special rule: Cedar Grove accepts food-soiled paper in compost!', wrongExplanation: 'Oops! In Seattle, greasy pizza boxes go in compost—this is different from other cities!' },
            { id: 16, name: 'Coffee Grounds & Filter', type: 'compost', emoji: '', level: 2, explanation: 'Correct! Coffee grounds are amazing for compost—worms love them!', wrongExplanation: 'Oops! Coffee grounds and paper filters go in compost, not garbage.' },
            { id: 17, name: 'Plastic Shopping Bag', type: 'garbage', emoji: '🛍️', level: 2, explanation: 'Correct! For curbside pickup, plastic bags go to garbage. However, many grocery stores collect clean plastic bags for separate recycling - find a location near you: http://plasticfilmrecycling.org', wrongExplanation: 'Oops! Plastic bags jam recycling machines in curbside pickup. They go to garbage, but you can take clean bags to grocery store drop-off bins! Visit http://plasticfilmrecycling.org to find locations.' },
            { id: 18, name: 'Chip Bag', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Chip bags are multi-layer packaging that goes to garbage.', wrongExplanation: 'Oops! Chip bags can\'t be recycled due to their foil lining.' },
            { id: 19, name: 'Non-Metallic Wrapping Paper', type: 'recycling', emoji: '🎁', level: 2, explanation: 'Correct! Non-metallic wrapping paper can be recycled!', wrongExplanation: 'Oops! Plain wrapping paper (no foil/glitter) goes in recycling.' },
            { id: 20, name: 'Small Bottle Cap (Loose)', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Loose bottle caps under 3" go to garbage—they jam machines!', wrongExplanation: 'Oops! Small loose caps go to garbage. Only attach caps to bottles for recycling.' },
            { id: 22, name: 'Pumpkin (Unpainted)', type: 'compost', emoji: '🎃', level: 2, explanation: 'Correct! Unpainted pumpkins are compostable—just remove any candles or decorations!', wrongExplanation: 'Oops! Clean, unpainted pumpkins go in compost, but painted ones go to garbage.' },
            { id: 23, name: 'Wire Coat Hanger', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Wire hangers jam recycling machines and go to garbage.', wrongExplanation: 'Oops! Wire hangers tangle in recycling equipment—they go to garbage.' },
            { id: 24, name: 'Plastic Food Container (Clean)', type: 'recycling', emoji: '', level: 2, explanation: 'Correct! Clean plastic food containers are recyclable!', wrongExplanation: 'Oops! Clean plastic containers go in recycling.' },
            { id: 25, name: 'Tissue Paper (No Tape)', type: 'compost', emoji: '🎀', level: 2, explanation: 'Correct! Tissue paper can be composted—short fibers are fine!', wrongExplanation: 'Oops! Clean tissue paper goes in compost, but remove tape first.' },
            { id: 26, name: 'Cotton Balls', type: 'garbage', emoji: '☁️', level: 2, explanation: 'Correct! Cotton balls risk contamination—Cedar Grove doesn\'t accept them.', wrongExplanation: 'Oops! Cotton balls often have synthetic fibers or chemicals—they go to garbage.' },
            { id: 27, name: 'Steel Wool', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Steel wool is too small and contaminated for recycling.', wrongExplanation: 'Oops! Steel wool tangles in machines and is usually contaminated—garbage only.' },
            { id: 28, name: 'Shredded Paper', type: ['compost', 'garbage'], emoji: '📃', level: 2, explanation: 'Correct! Shredded paper can go in compost OR garbage in Seattle—both are acceptable choices! See: https://www.seattle.gov/utilities/you-services/collection-and-disposal/where-does-it-go#item/shredded-paper', wrongExplanation: 'Oops! Shredded paper can go in either compost or garbage in Seattle—both are acceptable!' },
            { id: 29, name: 'Battery', type: 'hazardous', emoji: '🔋', level: 2, explanation: 'Correct! Batteries contain toxic chemicals and need hazardous waste disposal!', wrongExplanation: 'Oops! Batteries are hazardous—never put in regular bins!' },
            { id: 49, name: 'Chewing Gum', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Chewing gum is not biodegradable and goes to garbage—never spit it on sidewalks!', wrongExplanation: 'Oops! Chewing gum doesn\'t break down and goes to garbage, not compost or recycling.' },
            { id: 50, name: 'Plastic Straws', type: 'garbage', emoji: '', level: 2, explanation: 'Correct! Plastic straws are too small for recycling machines and go to garbage.', wrongExplanation: 'Oops! Plastic straws go to garbage—they\'re too small for recycling equipment.' },
            { id: 51, name: 'Condiment Packets', type: 'garbage', emoji: '🍯', level: 2, explanation: 'Correct! Small condiment packets are multi-layer packaging that goes to garbage.', wrongExplanation: 'Oops! Condiment packets can\'t be recycled due to their small size and mixed materials.' },
            { id: 52, name: 'Foil Drink Pouch (Capri Sun)', type: 'garbage', emoji: '🧃', level: 2, explanation: 'Correct! Foil drink pouches are multi-layer packaging that goes to garbage.', wrongExplanation: 'Oops! Foil drink pouches have mixed materials that can\'t be separated for recycling.' },
            
            // Level 3 - Hard items (15 items)
            { id: 31, name: 'CD/DVD', type: 'garbage', emoji: '💿', level: 3, explanation: 'Correct! CDs and DVDs go to garbage—the plastic is not recyclable.', wrongExplanation: 'Oops! CDs and DVDs can\'t be recycled in regular bins—they go to garbage.' },
            { id: 32, name: 'Styrofoam Container', type: 'garbage', emoji: '', level: 3, explanation: 'Correct! Styrofoam isn\'t recyclable in Seattle despite recycling symbols.', wrongExplanation: 'Oops! Styrofoam looks recyclable but goes to garbage—can\'t be processed in Seattle.' },
            { id: 33, name: 'Broken Glass (Wrapped)', type: 'garbage', emoji: '', level: 3, explanation: 'Correct! Broken glass goes to garbage if safely wrapped—not hazardous waste.', wrongExplanation: 'Oops! Wrap broken glass safely and put in garbage—only whole glass recycles.' },
            { id: 34, name: 'CFL Light Bulb', type: 'hazardous', emoji: '💡', level: 3, explanation: 'Correct! CFLs contain mercury and need hazardous waste disposal!', wrongExplanation: 'Oops! CFL bulbs have mercury—hazardous waste only! LED/incandescent go to garbage.' },
            { id: 35, name: 'LED Light Bulb', type: 'garbage', emoji: '', level: 3, explanation: 'Correct! LED bulbs go to garbage—only CFLs are hazardous.', wrongExplanation: 'Oops! LED bulbs go to garbage. Only CFL bulbs need hazardous waste disposal.' },
            { id: 36, name: 'Wood Stain', type: 'hazardous', emoji: '', level: 3, explanation: 'Correct! Wood stain contains chemicals that need hazardous waste disposal!', wrongExplanation: 'Oops! Wood stain is toxic—never put in regular bins or pour down drains!' },
            { id: 37, name: 'Rust Remover', type: 'hazardous', emoji: '', level: 3, explanation: 'Correct! Rust remover is corrosive and needs hazardous waste disposal!', wrongExplanation: 'Oops! Chemical rust removers are hazardous—protect workers and environment!' },
            { id: 38, name: 'Oven Cleaner (Aerosol)', type: 'hazardous', emoji: '', level: 3, explanation: 'Correct! Aerosol oven cleaners are toxic and pressurized—hazardous waste!', wrongExplanation: 'Oops! Aerosol cleaners are hazardous—chemicals plus pressure = special handling!' },
            { id: 39, name: 'Motor Oil-Soaked Paper Towels', type: 'garbage', emoji: '🛢️', level: 3, explanation: 'Correct! Chemical-contaminated paper towels go to garbage, not compost.', wrongExplanation: 'Oops! Chemical contamination makes paper towels garbage—only food-soiled goes to compost.' },
            { id: 40, name: 'Spot Remover (Aerosol)', type: 'hazardous', emoji: '', level: 3, explanation: 'Correct! Aerosol spot removers contain toxic solvents—hazardous waste!', wrongExplanation: 'Oops! Solvent-based spot removers are hazardous chemicals!' },
            { id: 42, name: 'Orange Prescription Bottle', type: 'garbage', emoji: '', level: 3, explanation: 'Correct! Orange prescription bottles are too brittle to recycle.', wrongExplanation: 'Oops! Orange/brown prescription bottles go to garbage—different plastic type.' },
            { id: 43, name: 'Hair (Human/Pet)', type: 'garbage', emoji: '💇', level: 3, explanation: 'Correct! Cedar Grove doesn\'t accept hair—licensing restrictions.', wrongExplanation: 'Oops! Hair is compostable but Cedar Grove can\'t accept human/pet hair.' },
            { id: 44, name: 'Pencil Shavings', type: 'garbage', emoji: '✏️', level: 3, explanation: 'Correct! Pencil shavings have paint and graphite—not compostable.', wrongExplanation: 'Oops! Paint and graphite make pencil shavings garbage, not compost.' },
            { id: 45, name: 'Wine Corks', type: 'garbage', emoji: '🍾', level: 3, explanation: 'Correct! Cork contamination issues make them garbage-bound.', wrongExplanation: 'Oops! Natural vs synthetic cork contamination makes all corks garbage.' },
            { id: 46, name: 'Waxed Paper', type: 'garbage', emoji: '📜', level: 3, explanation: 'Correct! Wax and plastic coatings make this garbage.', wrongExplanation: 'Oops! Waxed/coated papers have synthetic materials—they go to garbage.' }
        ];

        // Location messages with environmental impact
        const locationMessages = {
            1: {
                text: "🏭 Gas Works Park needs your help! Sort the scattered waste correctly to clean up this iconic Seattle landmark! 🧹",
                class: "level-1",
                impact: "Gas Works Park sits on a former industrial site. Proper sorting prevents contamination and keeps this beloved 19-acre park safe for families and wildlife visiting the iconic gasification towers!"
            },
            2: {
                text: "🏖️ Lake Union's beautiful shoreline has some litter! Help clean up this popular Seattle beach! 🌊",
                class: "level-2", 
                impact: "Lake Union connects to Puget Sound and the Pacific Ocean. Every piece of correctly sorted waste prevents marine pollution and protects salmon, seals, and orcas in Seattle's waters!"
            },
            3: {
                text: "🏙️ Perfect! Seattle's city center with the Space Needle is clean and beautiful thanks to your expertise! ✨",
                class: "level-3",
                impact: "Seattle Center hosts millions of visitors yearly! Proper waste sorting at this cultural heart keeps our city beautiful and shows the world that Seattle leads in environmental stewardship!"
            }
        };

        // Background generation functions
        function createLevel1Background() {
            return `
                <g opacity="0.6">
                    <rect x="800" y="200" width="15" height="80" fill="#708090"/>
                    <rect x="820" y="180" width="20" height="100" fill="#778899"/>
                    <rect x="845" y="190" width="18" height="90" fill="#708090"/>
                    <rect x="870" y="160" width="25" height="120" fill="#778899"/>
                </g>
                <g>
                    <rect x="200" y="200" width="40" height="200" fill="#696969"/>
                    <rect x="190" y="190" width="60" height="20" fill="#778899"/>
                    <rect x="300" y="280" width="25" height="120" fill="#696969"/>
                </g>
                <path d="M0 500 Q300 400 600 450 Q900 400 1200 480 L1200 800 L0 800 Z" fill="#7CFC00" opacity="0.8"/>
                <rect x="150" y="470" width="12" height="20" fill="#C0C0C0" transform="rotate(15 156 480)"/>
                <rect x="400" y="485" width="10" height="25" fill="#E6F3FF" transform="rotate(-20 405 497)"/>
                <rect x="600" y="465" width="20" height="15" fill="#FFD700" transform="rotate(45 610 472)"/>
                <rect x="250" y="490" width="25" height="18" fill="#F5F5F5" transform="rotate(-10 262 499)"/>
                <rect x="750" y="475" width="12" height="18" fill="#8B4513" transform="rotate(30 756 484)"/>
            `;
        }

        function createLevel2Background() {
            return `
                <g opacity="0.7">
                    <rect x="100" y="150" width="20" height="120" fill="#708090"/>
                    <rect x="125" y="130" width="25" height="140" fill="#778899"/>
                    <rect x="155" y="140" width="22" height="130" fill="#708090"/>
                </g>
                <g opacity="0.8">
                    <rect x="300" y="250" width="30" height="15" fill="#8B4513"/>
                    <rect x="305" y="240" width="20" height="15" fill="#CD853F"/>
                </g>
                <path d="M0 300 Q200 295 400 300 Q600 305 800 300 Q1000 295 1200 300 L1200 520 L0 520 Z" fill="#4682B4" opacity="0.8"/>
                <path d="M0 520 L1200 520 L1200 800 L0 800 Z" fill="#F4A460"/>
                <rect x="200" y="560" width="10" height="25" fill="#E6F3FF" transform="rotate(20 205 572)"/>
                <rect x="400" y="570" width="20" height="15" fill="#FFD700" transform="rotate(45 410 577)"/>
                <path d="M450 200 Q455 195 460 200 Q465 195 470 200" stroke="#FFFFFF" stroke-width="2" fill="none"/>
            `;
        }

        function createLevel3Background() {
            return `
                <g>
                    <rect x="580" y="500" width="40" height="20" fill="#C0C0C0"/>
                    <rect x="598" y="200" width="4" height="285" fill="#696969"/>
                    <ellipse cx="600" cy="165" rx="35" ry="12" fill="#E6E6FA"/>
                    <circle cx="600" cy="138" r="3" fill="#FF0000"/>
                </g>
                <g>
                    <rect x="300" y="150" width="35" height="180" fill="#4682B4"/>
                    <rect x="350" y="180" width="30" height="150" fill="#708090"/>
                    <rect x="450" y="160" width="40" height="170" fill="#4169E1"/>
                    <rect x="720" y="170" width="32" height="160" fill="#483D8B"/>
                </g>
                <rect x="0" y="330" width="1200" height="470" fill="#696969"/>
                <rect x="0" y="380" width="1200" height="420" fill="#228B22"/>
                <g opacity="0.7">
                    <ellipse cx="200" cy="80" rx="40" ry="20" fill="#FFFFFF"/>
                    <ellipse cx="600" cy="100" rx="50" ry="25" fill="#FFFFFF"/>
                </g>
            `;
        }

        // SVG emoji generator for specific items
        function generateSVGEmoji(itemId) {
            const svgSize = 80;
            let svgContent = '';
            
            switch(itemId) {
                case 1: // Clean Plastic Water Bottles - Dasani and Evian style with proper bottle shape
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <!-- Evian bottle (back left) with proper water bottle shape -->
                            <path d="M25 20 Q25 18 27 18 L33 18 Q35 18 35 20 L35 25 Q35 30 30 30 Q25 30 25 25 Z" 
                                  fill="#0ea5e9" stroke="#0284c7" stroke-width="1"/>
                            <path d="M20 25 Q20 23 25 23 L35 23 Q40 23 40 25 L42 35 Q42 40 40 40 L35 75 Q35 80 30 80 L25 80 Q20 80 20 75 L18 35 Q18 30 20 25 Z" 
                                  fill="#f0f9ff" stroke="#0ea5e9" stroke-width="2" opacity="0.9"/>
                            
                            <!-- Evian bottle ridges for texture -->
                            <path d="M20 35 Q30 33 40 35" stroke="#0ea5e9" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M20 45 Q30 43 40 45" stroke="#0ea5e9" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M21 55 Q30 53 39 55" stroke="#0ea5e9" stroke-width="0.5" fill="none" opacity="0.7"/>
                            
                            <!-- Evian label -->
                            <rect x="23" y="40" width="14" height="18" fill="#ec4899" stroke="#db2777" stroke-width="1" rx="2"/>
                            <text x="30" y="46" text-anchor="middle" font-size="3" fill="white" font-weight="bold">evian</text>
                            <text x="30" y="50" text-anchor="middle" font-size="2" fill="white" font-weight="bold">NATURAL</text>
                            <text x="30" y="53" text-anchor="middle" font-size="2" fill="white" font-weight="bold">SPRING</text>
                            <text x="30" y="56" text-anchor="middle" font-size="2" fill="white" font-weight="bold">WATER</text>
                            
                            <!-- Dasani bottle (front right) with proper water bottle shape -->
                            <path d="M55 15 Q55 13 57 13 L63 13 Q65 13 65 15 L65 20 Q65 25 60 25 Q55 25 55 20 Z" 
                                  fill="#3b82f6" stroke="#1d4ed8" stroke-width="1"/>
                            <path d="M45 20 Q45 18 55 18 L65 18 Q75 18 75 20 L77 30 Q77 35 75 35 L75 40 Q77 42 77 45 L75 70 Q75 85 60 85 Q45 85 45 70 L43 45 Q43 42 45 40 L45 35 Q43 35 43 30 L45 20 Z" 
                                  fill="#f8fafc" stroke="#3b82f6" stroke-width="2"/>
                            
                            <!-- Dasani bottle shoulder ridges -->
                            <path d="M45 35 Q60 33 75 35" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M45 42 Q60 40 75 42" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            
                            <!-- Dasani bottle grip ridges -->
                            <path d="M47 50 Q60 48 73 50" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M47 55 Q60 53 73 55" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M47 60 Q60 58 73 60" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            <path d="M47 65 Q60 63 73 65" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.7"/>
                            
                            <!-- Dasani label -->
                            <rect x="50" y="45" width="20" height="15" fill="#1e40af" stroke="#1d4ed8" stroke-width="1" rx="2"/>
                            <text x="60" y="50" text-anchor="middle" font-size="4" fill="white" font-weight="bold">DASANI</text>
                            <text x="60" y="54" text-anchor="middle" font-size="2.5" fill="white" font-weight="bold">PURIFIED</text>
                            <text x="60" y="57" text-anchor="middle" font-size="2.5" fill="white" font-weight="bold">WATER</text>
                            
                            <!-- Water effects inside bottles -->
                            <ellipse cx="30" cy="50" rx="6" ry="12" fill="#e0f2fe" opacity="0.4"/>
                            <ellipse cx="60" cy="55" rx="8" ry="15" fill="#dbeafe" opacity="0.4"/>
                            
                            <!-- Bottle highlights on shoulder -->
                            <ellipse cx="26" cy="35" rx="2" ry="5" fill="#ffffff" opacity="0.8"/>
                            <ellipse cx="56" cy="35" rx="3" ry="6" fill="#ffffff" opacity="0.8"/>
                            
                            <!-- Recycling symbols -->
                            <circle cx="33" cy="30" r="3" fill="none" stroke="#22c55e" stroke-width="1"/>
                            <text x="33" y="32" text-anchor="middle" font-size="2" fill="#22c55e" font-weight="bold">♻</text>
                            <circle cx="68" cy="32" r="3" fill="none" stroke="#22c55e" stroke-width="1"/>
                            <text x="68" y="34" text-anchor="middle" font-size="2" fill="#22c55e" font-weight="bold">♻</text>
                            
                            <!-- Clean indicator -->
                            <rect x="15" y="90" width="70" height="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1" rx="3"/>
                            <text x="50" y="94" text-anchor="middle" font-size="3" fill="#16a34a" font-weight="bold">✓ CLEAN & EMPTY</text>
                        </svg>`;
                    break;
                    
                case 13: // Paper towel - Individual kitchen paper towel sheets
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <rect x="25" y="20" width="30" height="40" fill="#ffffff" stroke="#ddd" stroke-width="2" rx="3"/>
                            <rect x="27" y="18" width="30" height="40" fill="#f8f8f8" stroke="#e0e0e0" stroke-width="1" rx="3"/>
                            <rect x="29" y="16" width="30" height="40" fill="#f5f5f5" stroke="#e5e5e5" stroke-width="1" rx="3"/>
                            <line x1="25" y1="30" x2="55" y2="30" stroke="#ccc" stroke-width="1" stroke-dasharray="3,2"/>
                            <line x1="27" y1="40" x2="57" y2="40" stroke="#ddd" stroke-width="1" stroke-dasharray="3,2"/>
                            <line x1="29" y1="35" x2="59" y2="35" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="3,2"/>
                            <circle cx="35" cy="25" r="1" fill="#e8e8e8" opacity="0.5"/>
                            <circle cx="45" cy="45" r="1" fill="#e8e8e8" opacity="0.5"/>
                            <circle cx="50" cy="28" r="1" fill="#e8e8e8" opacity="0.5"/>
                            <text x="44" y="50" text-anchor="middle" font-size="5" fill="#ccc" font-weight="bold">KITCHEN</text>
                        </svg>`;
                    break;
                    
                case 38: // Oven cleaner - Blue aerosol can
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <rect x="30" y="20" width="20" height="35" fill="#4169e1" stroke="#2c5aa0" stroke-width="2" rx="10"/>
                            <rect x="35" y="15" width="10" height="8" fill="#666" stroke="#444" stroke-width="2" rx="2"/>
                            <rect x="32" y="30" width="16" height="8" fill="#ffffff" rx="2"/>
                            <text x="40" y="35" text-anchor="middle" font-size="5" fill="#4169e1" font-weight="bold">OVEN</text>
                            <text x="40" y="41" text-anchor="middle" font-size="5" fill="#4169e1" font-weight="bold">CLEAN</text>
                            <path d="M38 15 L40 8 L42 15" fill="#444"/>
                            <path d="M36 8 Q40 5 44 8" fill="none" stroke="#87ceeb" stroke-width="2"/>
                        </svg>`;
                    break;
                    
                case 8: // Aluminum pie plate - Ridged disposable aluminum plate
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <ellipse cx="40" cy="40" rx="32" ry="20" fill="#c0c0c0" stroke="#a0a0a0" stroke-width="2"/>
                            <ellipse cx="40" cy="38" rx="28" ry="16" fill="#e8e8e8" stroke="#d0d0d0" stroke-width="1"/>
                            <ellipse cx="40" cy="36" rx="22" ry="12" fill="#f0f0f0" stroke="#e0e0e0" stroke-width="1"/>
                            <ellipse cx="40" cy="36" rx="18" ry="9" fill="none" stroke="#d8d8d8" stroke-width="0.5"/>
                            <ellipse cx="40" cy="36" rx="14" ry="7" fill="none" stroke="#d8d8d8" stroke-width="0.5"/>
                            <ellipse cx="40" cy="36" rx="10" ry="5" fill="none" stroke="#d8d8d8" stroke-width="0.5"/>
                            <ellipse cx="35" cy="33" rx="8" ry="3" fill="#ffffff" opacity="0.6"/>
                        </svg>`;
                    break;
                    
                case 27: // Steel wool - Dense pad of steel fibers
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <ellipse cx="40" cy="40" rx="25" ry="15" fill="#778899" stroke="#556b7d" stroke-width="2"/>
                            <g stroke="#606060" stroke-width="0.8" fill="none" opacity="0.8">
                                <path d="M20 35 Q25 30 30 35 Q35 40 40 35 Q45 30 50 35 Q55 40 60 35"/>
                                <path d="M18 37 Q23 32 28 37 Q33 42 38 37 Q43 32 48 37 Q53 42 58 37"/>
                                <path d="M22 39 Q27 34 32 39 Q37 44 42 39 Q47 34 52 39 Q57 44 62 39"/>
                                <path d="M19 41 Q24 36 29 41 Q34 46 39 41 Q44 36 49 41 Q54 46 59 41"/>
                                <path d="M21 43 Q26 38 31 43 Q36 48 41 43 Q46 38 51 43 Q56 48 61 43"/>
                                <path d="M17 45 Q22 40 27 45 Q32 50 37 45 Q42 40 47 45 Q52 50 57 45"/>
                            </g>
                            <g stroke="#708090" stroke-width="0.6" fill="none" opacity="0.9">
                                <path d="M25 33 Q30 38 35 33 Q40 28 45 33 Q50 38 55 33"/>
                                <path d="M23 36 Q28 41 33 36 Q38 31 43 36 Q48 41 53 36"/>
                                <path d="M27 38 Q32 43 37 38 Q42 33 47 38 Q52 43 57 38"/>
                                <path d="M24 40 Q29 45 34 40 Q39 35 44 40 Q49 45 54 40"/>
                                <path d="M26 42 Q31 47 36 42 Q41 37 46 42 Q51 47 56 42"/>
                            </g>
                            <ellipse cx="35" cy="35" rx="3" ry="1.5" fill="#c0c0c0" opacity="0.7"/>
                            <ellipse cx="45" cy="42" rx="2" ry="1" fill="#c0c0c0" opacity="0.7"/>
                        </svg>`;
                    break;
                    
                case 23: // Wire coat hanger - Triangular wire hanger
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <path d="M40 10 Q37 8 37 12 Q37 15 40 15" fill="none" stroke="#708090" stroke-width="3" stroke-linecap="round"/>
                            <path d="M40 15 L20 35 L20 40 L60 40 L60 35 Z" fill="none" stroke="#708090" stroke-width="3" stroke-linejoin="round"/>
                            <line x1="20" y1="40" x2="60" y2="40" stroke="#708090" stroke-width="3" stroke-linecap="round"/>
                            <line x1="30" y1="25" x2="30" y2="27" stroke="#556b7d" stroke-width="1" opacity="0.7"/>
                            <line x1="50" y1="25" x2="50" y2="27" stroke="#556b7d" stroke-width="1" opacity="0.7"/>
                            <line x1="35" y1="40" x2="35" y2="42" stroke="#556b7d" stroke-width="1" opacity="0.7"/>
                            <line x1="45" y1="40" x2="45" y2="42" stroke="#556b7d" stroke-width="1" opacity="0.7"/>
                            <line x1="42" y1="17" x2="44" y2="19" stroke="#a0a0a0" stroke-width="1" opacity="0.8"/>
                            <line x1="25" y1="38" x2="27" y2="38" stroke="#a0a0a0" stroke-width="1" opacity="0.8"/>
                        </svg>`;
                    break;
                    
                case 16: // Coffee grounds & filter - Cone-shaped filter with grounds
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <path d="M25 20 L55 20 L50 35 L30 35 Z" fill="#e8e8e8" stroke="#ccc" stroke-width="2"/>
                            <path d="M30 22 L50 22 L47 45 L33 45 Z" fill="#ffffff" stroke="#ddd" stroke-width="2"/>
                            <ellipse cx="40" cy="28" rx="8" ry="3" fill="#8b4513"/>
                            <circle cx="37" cy="27" r="1" fill="#654321"/>
                            <circle cx="43" cy="29" r="1" fill="#654321"/>
                            <circle cx="40" cy="31" r="1" fill="#654321"/>
                            <circle cx="35" cy="30" r="0.8" fill="#654321"/>
                            <circle cx="45" cy="26" r="0.8" fill="#654321"/>
                            <ellipse cx="40" cy="38" rx="6" ry="4" fill="#8b4513" opacity="0.7"/>
                            <circle cx="38" cy="37" r="0.8" fill="#654321"/>
                            <circle cx="42" cy="39" r="0.8" fill="#654321"/>
                            <line x1="35" y1="22" x2="33" y2="45" stroke="#f0f0f0" stroke-width="1"/>
                            <line x1="40" y1="22" x2="40" y2="45" stroke="#f0f0f0" stroke-width="1"/>
                            <line x1="45" y1="22" x2="47" y2="45" stroke="#f0f0f0" stroke-width="1"/>
                        </svg>`;
                    break;
                    
                case 36: // Wood stain - Can with label and brush
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <rect x="28" y="25" width="24" height="35" fill="#8b4513" stroke="#654321" stroke-width="2" rx="2"/>
                            <rect x="30" y="30" width="20" height="25" fill="#daa520" stroke="#b8860b" stroke-width="1" rx="1"/>
                            <text x="40" y="38" text-anchor="middle" font-size="6" fill="#8b4513" font-weight="bold">WOOD</text>
                            <text x="40" y="46" text-anchor="middle" font-size="6" fill="#8b4513" font-weight="bold">STAIN</text>
                            <path d="M32 50 Q35 48 38 50 Q41 52 44 50 Q47 48 48 50" stroke="#cd853f" stroke-width="1" fill="none"/>
                            <path d="M32 52 Q35 50 38 52 Q41 54 44 52 Q47 50 48 52" stroke="#cd853f" stroke-width="1" fill="none"/>
                            <ellipse cx="40" cy="25" rx="12" ry="3" fill="#654321" stroke="#4a2c17" stroke-width="1"/>
                            <rect x="52" y="20" width="3" height="25" fill="#8b4513" stroke="#654321" stroke-width="1"/>
                            <ellipse cx="53.5" cy="18" rx="2.5" ry="3" fill="#daa520" stroke="#b8860b" stroke-width="1"/>
                            <path d="M51 45 L51 48 M52 45 L52 49 M53 45 L53 48 M54 45 L54 49 M55 45 L55 48 M56 45 L56 49" stroke="#654321" stroke-width="1"/>
                        </svg>`;
                    break;
                    
                case 9: // Milk carton - Fold-top carton with MILK label
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <path d="M25 20 L25 55 Q25 60 30 60 L50 60 Q55 60 55 55 L55 20 L45 10 L35 10 Z" 
                                  fill="#ffffff" stroke="#ddd" stroke-width="2"/>
                            <path d="M35 10 L40 5 L45 10" fill="#ffffff" stroke="#ddd" stroke-width="2"/>
                            <rect x="30" y="25" width="20" height="15" fill="#4169e1" rx="2"/>
                            <text x="40" y="35" text-anchor="middle" font-size="8" fill="white" font-weight="bold">MILK</text>
                            <circle cx="32" cy="50" r="2" fill="#e0e0e0"/>
                        </svg>`;
                    break;
                    
                case 35: // LED light bulb - Modern LED with blue indicators
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <circle cx="40" cy="30" r="15" fill="#f0f8ff" stroke="#ddd" stroke-width="2"/>
                            <rect x="35" y="45" width="10" height="8" fill="#e8e8e8" stroke="#ccc" stroke-width="1"/>
                            <rect x="37" y="53" width="6" height="4" fill="#444" stroke="#333" stroke-width="1"/>
                            <path d="M32 25 L48 35 M32 35 L48 25" stroke="#4169e1" stroke-width="2"/>
                            <circle cx="40" cy="30" r="3" fill="#4169e1"/>
                        </svg>`;
                    break;
                    
                case 37: // Rust remover - Orange chemical bottle
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 80 80">
                            <rect x="30" y="15" width="20" height="40" fill="#ff6b35" stroke="#cc4125" stroke-width="2" rx="10"/>
                            <rect x="35" y="10" width="10" height="10" fill="#444" stroke="#333" stroke-width="2" rx="2"/>
                            <rect x="32" y="25" width="16" height="8" fill="#ffffff" rx="2"/>
                            <text x="40" y="30" text-anchor="middle" font-size="6" fill="#ff6b35" font-weight="bold">RUST</text>
                            <text x="40" y="37" text-anchor="middle" font-size="6" fill="#ff6b35" font-weight="bold">GONE</text>
                            <path d="M37 10 L40 5 L43 10" fill="#666"/>
                        </svg>`;
                    break;
                    
                case 40: // Spot remover - Blue bottle with trigger and spray
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <ellipse cx="55" cy="50" rx="18" ry="25" fill="#4169e1" stroke="#2c5aa0" stroke-width="2"/>
                            <path d="M37 45 Q30 40 25 45 Q30 50 37 45" fill="#666" stroke="#444" stroke-width="2"/>
                            <rect x="25" y="42" width="15" height="6" fill="#333" stroke="#222" stroke-width="1" rx="3"/>
                            <ellipse cx="55" cy="45" rx="12" ry="8" fill="#ffffff" stroke="#ddd" stroke-width="1"/>
                            <text x="55" y="47" text-anchor="middle" font-size="6" fill="#4169e1" font-weight="bold">SPOT</text>
                            <text x="55" y="52" text-anchor="middle" font-size="5" fill="#4169e1" font-weight="bold">OUT</text>
                            <ellipse cx="55" cy="25" rx="8" ry="4" fill="#333" stroke="#222" stroke-width="1"/>
                            <circle cx="15" cy="43" r="1.5" fill="#87ceeb" opacity="0.7"/>
                            <circle cx="12" cy="40" r="1" fill="#87ceeb" opacity="0.5"/>
                            <circle cx="10" cy="45" r="0.8" fill="#87ceeb" opacity="0.6"/>
                            <circle cx="8" cy="42" r="0.6" fill="#87ceeb" opacity="0.4"/>
                            <circle cx="13" cy="47" r="1.2" fill="#87ceeb" opacity="0.8"/>
                        </svg>`;
                    break;
                    
                case 15: // Greasy pizza box - Mario's Pizza with heavy grease stains
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <rect x="15" y="35" width="70" height="45" fill="#deb887" stroke="#8b7355" stroke-width="2" rx="4"/>
                            <rect x="15" y="20" width="70" height="20" fill="#f5deb3" stroke="#8b7355" stroke-width="2" rx="4"/>
                            <line x1="15" y1="40" x2="85" y2="40" stroke="#8b7355" stroke-width="2"/>
                            <ellipse cx="30" cy="55" rx="8" ry="6" fill="#b8860b" opacity="0.8"/>
                            <ellipse cx="60" cy="65" rx="10" ry="7" fill="#b8860b" opacity="0.7"/>
                            <ellipse cx="50" cy="50" rx="6" ry="5" fill="#b8860b" opacity="0.6"/>
                            <circle cx="35" cy="45" r="2" fill="#8b4513" opacity="0.9"/>
                            <circle cx="65" cy="55" r="1.5" fill="#8b4513" opacity="0.8"/>
                            <circle cx="45" cy="70" r="1.8" fill="#8b4513" opacity="0.7"/>
                            <rect x="25" y="25" width="50" height="10" fill="#ffffff" stroke="#ccc" stroke-width="1" rx="2"/>
                            <text x="50" y="32" text-anchor="middle" font-size="8" fill="#8b7355" font-weight="bold">MARIO'S PIZZA</text>
                            <ellipse cx="40" cy="30" rx="4" ry="2" fill="#b8860b" opacity="0.4"/>
                        </svg>`;
                    break;
                    
                case 24: // Plastic food container - Clear with recycling #5
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <rect x="25" y="40" width="50" height="35" fill="#f8fafc" stroke="#cbd5e1" stroke-width="2" rx="6"/>
                            <rect x="22" y="30" width="56" height="15" fill="#e2e8f0" stroke="#94a3b8" stroke-width="2" rx="6"/>
                            <rect x="25" y="35" width="50" height="8" fill="#ffffff" stroke="#cbd5e1" stroke-width="1" rx="4"/>
                            <circle cx="50" cy="57" r="12" fill="none" stroke="#2563eb" stroke-width="2"/>
                            <path d="M42 50 L50 45 L58 50" stroke="#2563eb" stroke-width="2" fill="none" stroke-linecap="round"/>
                            <path d="M58 50 Q63 57 58 64 L50 69 L42 64" stroke="#2563eb" stroke-width="2" fill="none" stroke-linecap="round"/>
                            <path d="M42 64 Q37 57 42 50" stroke="#2563eb" stroke-width="2" fill="none" stroke-linecap="round"/>
                            <circle cx="50" cy="57" r="6" fill="#2563eb"/>
                            <text x="50" y="61" text-anchor="middle" font-size="8" fill="white" font-weight="bold">5</text>
                            <line x1="28" y1="50" x2="72" y2="50" stroke="#e2e8f0" stroke-width="1"/>
                            <line x1="28" y1="65" x2="72" y2="65" stroke="#e2e8f0" stroke-width="1"/>
                            <circle cx="35" cy="45" r="2" fill="#22c55e" opacity="0.8"/>
                            <text x="40" y="47" text-anchor="start" font-size="4" fill="#22c55e" font-weight="bold">CLEAN</text>
                        </svg>`;
                    break;
                    
                case 20: // Small bottle cap - Red with size measurement
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="20" fill="#ef4444" stroke="#dc2626" stroke-width="3"/>
                            <g stroke="#dc2626" stroke-width="2" fill="none">
                                <line x1="50" y1="30" x2="50" y2="25"/>
                                <line x1="64.14" y1="35.86" x2="67.07" y2="32.93"/>
                                <line x1="70" y1="50" x2="75" y2="50"/>
                                <line x1="64.14" y1="64.14" x2="67.07" y2="67.07"/>
                                <line x1="50" y1="70" x2="50" y2="75"/>
                                <line x1="35.86" y1="64.14" x2="32.93" y2="67.07"/>
                                <line x1="30" y1="50" x2="25" y2="50"/>
                                <line x1="35.86" y1="35.86" x2="32.93" y2="32.93"/>
                            </g>
                            <circle cx="50" cy="50" r="15" fill="none" stroke="#fecaca" stroke-width="1"/>
                            <circle cx="50" cy="50" r="10" fill="none" stroke="#fecaca" stroke-width="1"/>
                            <circle cx="50" cy="50" r="8" fill="#ffffff" opacity="0.9"/>
                            <text x="50" y="53" text-anchor="middle" font-size="6" fill="#ef4444" font-weight="bold">CAP</text>
                            <line x1="30" y1="85" x2="70" y2="85" stroke="#666" stroke-width="2"/>
                            <line x1="30" y1="82" x2="30" y2="88" stroke="#666" stroke-width="2"/>
                            <line x1="70" y1="82" x2="70" y2="88" stroke="#666" stroke-width="2"/>
                            <text x="50" y="95" text-anchor="middle" font-size="7" fill="#666" font-weight="bold">2.5" diameter</text>
                        </svg>`;
                    break;
                    
                case 42: // Orange prescription bottle - Amber with child-resistant cap
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <rect x="35" y="25" width="30" height="50" fill="#ff8c00" stroke="#e67e00" stroke-width="2" rx="6"/>
                            <rect x="32" y="15" width="36" height="15" fill="#ffffff" stroke="#ddd" stroke-width="2" rx="6"/>
                            <rect x="35" y="18" width="30" height="8" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" rx="4"/>
                            <text x="50" y="23" text-anchor="middle" font-size="4" fill="#666" font-weight="bold">PUSH DOWN</text>
                            <rect x="37" y="30" width="26" height="35" fill="#ffffff" stroke="#ddd" stroke-width="1" rx="3"/>
                            <rect x="37" y="30" width="26" height="8" fill="#1e40af" rx="3 3 0 0"/>
                            <text x="50" y="36" text-anchor="middle" font-size="4" fill="white" font-weight="bold">RxPHARMACY</text>
                            <text x="50" y="43" text-anchor="middle" font-size="5" fill="#000" font-weight="bold">RX 987654</text>
                            <rect x="39" y="46" width="22" height="2" fill="#ff8c00"/>
                            <rect x="39" y="50" width="18" height="1.5" fill="#9ca3af"/>
                            <rect x="39" y="53" width="20" height="1.5" fill="#9ca3af"/>
                            <rect x="39" y="56" width="16" height="1.5" fill="#9ca3af"/>
                            <rect x="39" y="59" width="22" height="1.5" fill="#9ca3af"/>
                            <rect x="67" y="40" width="12" height="20" fill="#fef2f2" stroke="#ef4444" stroke-width="1" rx="2"/>
                            <text x="73" y="52" text-anchor="middle" font-size="3" fill="#dc2626" font-weight="bold">⚠</text>
                        </svg>`;
                    break;
                    
                case 18: // Chip bag - More rectangular crispy chips bag with foil lining
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <rect x="25" y="15" width="50" height="70" fill="#ffd700" stroke="#b8860b" stroke-width="2" rx="8"/>
                            <rect x="27" y="17" width="46" height="66" fill="#c0c0c0" stroke="#a0a0a0" stroke-width="1" rx="6"/>
                            <rect x="35" y="25" width="30" height="15" fill="#dc2626" stroke="#b91c1c" stroke-width="2" rx="3"/>
                            <text x="50" y="34" text-anchor="middle" font-size="7" fill="white" font-weight="bold">CRISPY</text>
                            <text x="50" y="42" text-anchor="middle" font-size="6" fill="white" font-weight="bold">CHIPS</text>
                            <line x1="30" y1="45" x2="70" y2="45" stroke="#e5e7eb" stroke-width="1" opacity="0.8"/>
                            <line x1="30" y1="55" x2="70" y2="55" stroke="#e5e7eb" stroke-width="1" opacity="0.8"/>
                            <line x1="30" y1="65" x2="70" y2="65" stroke="#e5e7eb" stroke-width="1" opacity="0.8"/>
                            <path d="M30 50 Q35 48 40 50 Q45 52 50 50 Q55 48 60 50 Q65 52 70 50" stroke="#9ca3af" stroke-width="1" fill="none"/>
                            <path d="M30 60 Q35 58 40 60 Q45 62 50 60 Q55 58 60 60 Q65 62 70 60" stroke="#9ca3af" stroke-width="1" fill="none"/>
                            <path d="M30 70 Q35 68 40 70 Q45 72 50 70 Q55 68 60 70 Q65 72 70 70" stroke="#9ca3af" stroke-width="1" fill="none"/>
                            <rect x="27" y="15" width="46" height="4" fill="#8b7355" stroke="#6d5d47" stroke-width="1"/>
                            <rect x="77" y="30" width="18" height="8" fill="#fef2f2" stroke="#f87171" stroke-width="1" rx="2"/>
                            <text x="86" y="35" text-anchor="middle" font-size="4" fill="#dc2626" font-weight="bold">FOIL LINING</text>
                        </svg>`;
                    break;
                    
                case 33: // Broken glass - Multiple shards with warnings
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <path d="M25 45 L45 25 L40 50 L20 55 Z" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M45 25 L65 35 L60 55 L40 50 Z" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M65 35 L80 20 L85 45 L60 55 Z" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M20 55 L40 50 L35 75 L15 70 Z" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M40 50 L60 55 L65 80 L35 75 Z" fill="#e0f2fe" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M60 55 L85 45 L80 75 L65 80 Z" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="2"/>
                            <path d="M30 40 L35 35 L33 45" fill="#ffffff" opacity="0.7"/>
                            <path d="M50 40 L55 37 L52 47" fill="#ffffff" opacity="0.7"/>
                            <path d="M70 40 L75 37 L72 42" fill="#ffffff" opacity="0.7"/>
                            <path d="M45 25 L48 20 M40 50 L43 47 M65 35 L68 30" stroke="#dc2626" stroke-width="3" stroke-linecap="round"/>
                            <path d="M80 20 L83 15 M60 55 L63 50 M35 75 L38 70" stroke="#dc2626" stroke-width="3" stroke-linecap="round"/>
                            <rect x="35" y="5" width="30" height="12" fill="#fef2f2" stroke="#f87171" stroke-width="2" rx="6"/>
                            <text x="50" y="13" text-anchor="middle" font-size="7" fill="#dc2626" font-weight="bold">⚠ SHARP!</text>
                            <rect x="15" y="85" width="70" height="8" fill="#f3f4f6" stroke="#9ca3af" stroke-width="1" rx="2"/>
                            <text x="50" y="90" text-anchor="middle" font-size="5" fill="#6b7280" font-weight="bold">WRAP IN NEWSPAPER</text>
                        </svg>`;
                    break;
                    
                case 32: // Styrofoam container - White foam with misleading symbol
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <rect x="20" y="35" width="60" height="40" fill="#ffffff" stroke="#e5e7eb" stroke-width="2" rx="6"/>
                            <rect x="17" y="25" width="66" height="15" fill="#f8fafc" stroke="#cbd5e1" stroke-width="2" rx="6"/>
                            <line x1="17" y1="40" x2="83" y2="40" stroke="#94a3b8" stroke-width="1"/>
                            <circle cx="25" cy="45" r="1.5" fill="#f1f5f9"/>
                            <circle cx="35" cy="42" r="1.8" fill="#f1f5f9"/>
                            <circle cx="45" cy="48" r="1.2" fill="#f1f5f9"/>
                            <circle cx="55" cy="45" r="1.6" fill="#f1f5f9"/>
                            <circle cx="65" cy="50" r="1.4" fill="#f1f5f9"/>
                            <circle cx="75" cy="45" r="1.3" fill="#f1f5f9"/>
                            <circle cx="30" cy="55" r="1.1" fill="#f1f5f9"/>
                            <circle cx="40" cy="58" r="1.7" fill="#f1f5f9"/>
                            <circle cx="50" cy="55" r="1.5" fill="#f1f5f9"/>
                            <circle cx="60" cy="60" r="1.2" fill="#f1f5f9"/>
                            <circle cx="70" cy="55" r="1.4" fill="#f1f5f9"/>
                            <circle cx="25" cy="65" r="1.3" fill="#f1f5f9"/>
                            <circle cx="45" cy="68" r="1.1" fill="#f1f5f9"/>
                            <circle cx="65" cy="65" r="1.6" fill="#f1f5f9"/>
                            <circle cx="70" cy="35" r="6" fill="none" stroke="#10b981" stroke-width="2"/>
                            <path d="M66 31 L70 28 L74 31 M70 28 L70 42 M66 38 L70 42 L74 38" stroke="#10b981" stroke-width="2" fill="none"/>
                            <text x="70" y="37" text-anchor="middle" font-size="5" fill="#10b981" font-weight="bold">6</text>
                            <rect x="5" y="80" width="90" height="12" fill="#fef2f2" stroke="#f87171" stroke-width="1" rx="6"/>
                            <text x="50" y="88" text-anchor="middle" font-size="6" fill="#dc2626" font-weight="bold">NOT RECYCLABLE DESPITE SYMBOL!</text>
                            <text x="50" y="58" text-anchor="middle" font-size="8" fill="#9ca3af" font-weight="bold">FOAM</text>
                        </svg>`;
                    break;
                    
                case 47: // Coffee cup (Starbucks style) - Paper cup with sleeve and logo
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <path d="M30 20 Q30 15 35 15 L65 15 Q70 15 70 20 L75 75 Q75 80 70 80 L30 80 Q25 80 25 75 Z" fill="#ffffff" stroke="#d1d5db" stroke-width="2"/>
                            <rect x="28" y="35" width="44" height="25" fill="#0f5132" stroke="#0a3d26" stroke-width="1" rx="3"/>
                            <circle cx="50" cy="47" r="8" fill="none" stroke="#ffffff" stroke-width="2"/>
                            <circle cx="50" cy="47" r="6" fill="#ffffff"/>
                            <text x="50" y="50" text-anchor="middle" font-size="6" fill="#0f5132" font-weight="bold">★</text>
                            <ellipse cx="50" cy="15" rx="20" ry="3" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
                            <path d="M45 65 Q50 70 55 65" stroke="#d1d5db" stroke-width="1" fill="none"/>
                            <path d="M40 70 Q50 75 60 70" stroke="#d1d5db" stroke-width="1" fill="none"/>
                            <rect x="35" y="25" width="30" height="3" fill="#8b7355" stroke="#6d5d47" stroke-width="1" rx="1"/>
                            <text x="50" y="40" text-anchor="middle" font-size="4" fill="#ffffff" font-weight="bold">STARBUCKS</text>
                            <text x="50" y="55" text-anchor="middle" font-size="4" fill="#ffffff" font-weight="bold">COFFEE</text>
                        </svg>`;
                    break;
                    
                case 48: // Juice box with straw next to it on ground - Tetrapak style
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <path d="M25 20 L25 70 Q25 75 30 75 L70 75 Q75 75 75 70 L75 20 L65 10 L35 10 Z" 
                                  fill="#ffd700" stroke="#e6ac00" stroke-width="2"/>
                            <path d="M35 10 L50 5 L65 10" fill="#ffd700" stroke="#e6ac00" stroke-width="2"/>
                            <rect x="30" y="25" width="40" height="20" fill="#ff6b35" stroke="#cc4125" stroke-width="2" rx="3"/>
                            <text x="50" y="33" text-anchor="middle" font-size="8" fill="white" font-weight="bold">ORANGE</text>
                            <text x="50" y="41" text-anchor="middle" font-size="6" fill="white" font-weight="bold">JUICE</text>
                            <circle cx="35" cy="60" r="2" fill="#e6ac00"/>
                            <ellipse cx="50" cy="55" rx="15" ry="8" fill="#ffcc00" opacity="0.7"/>
                            <text x="50" y="58" text-anchor="middle" font-size="5" fill="#cc4125" font-weight="bold">100% JUICE</text>
                            <!-- Straw on the ground next to juice box -->
                            <rect x="80" y="70" width="15" height="3" fill="#ff69b4" stroke="#e6578a" stroke-width="1" rx="1"/>
                            <rect x="78" y="68" width="4" height="7" fill="#ff69b4" stroke="#e6578a" stroke-width="1" rx="1"/>
                            <circle cx="85" cy="76" r="1" fill="#ff69b4"/>
                            <circle cx="90" cy="76" r="1" fill="#ff69b4"/>
                        </svg>`;
                    break;
                    
                case 49: // Chewing gum - Person blowing a bubble
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <!-- Person's head -->
                            <circle cx="35" cy="45" r="12" fill="#ffdbac" stroke="#e6c49a" stroke-width="2"/>
                            <!-- Eyes -->
                            <circle cx="31" cy="42" r="1.5" fill="#333"/>
                            <circle cx="39" cy="42" r="1.5" fill="#333"/>
                            <!-- Nose -->
                            <circle cx="35" cy="46" r="0.8" fill="#e6c49a"/>
                            <!-- Hair -->
                            <path d="M25 38 Q35 25 45 38" fill="#8b4513" stroke="#654321" stroke-width="1"/>
                            <!-- Mouth area -->
                            <ellipse cx="35" cy="52" rx="3" ry="2" fill="#ff69b4"/>
                            <!-- Giant pink bubble gum bubble -->
                            <circle cx="55" cy="50" r="18" fill="#ffb3d9" stroke="#ff8cc8" stroke-width="2" opacity="0.9"/>
                            <!-- Bubble highlight -->
                            <ellipse cx="60" cy="45" rx="6" ry="4" fill="#ffffff" opacity="0.6"/>
                            <!-- Smaller highlight -->
                            <circle cx="65" cy="42" r="2" fill="#ffffff" opacity="0.8"/>
                            <!-- Bubble connection to mouth -->
                            <path d="M38 52 Q45 51 50 50" stroke="#ff8cc8" stroke-width="3" fill="none"/>
                            <!-- Bubble texture lines -->
                            <path d="M45 45 Q50 40 55 45" stroke="#ff99cc" stroke-width="1" fill="none" opacity="0.7"/>
                            <path d="M50 55 Q55 60 60 55" stroke="#ff99cc" stroke-width="1" fill="none" opacity="0.7"/>
                            <path d="M40 50 Q45 48 50 50" stroke="#ff99cc" stroke-width="1" fill="none" opacity="0.7"/>
                            <!-- Warning label -->
                            <rect x="15" y="75" width="70" height="12" fill="#fef2f2" stroke="#dc2626" stroke-width="1" rx="6"/>
                            <text x="50" y="83" text-anchor="middle" font-size="6" fill="#dc2626" font-weight="bold">⚠ CHEWING GUM BUBBLE!</text>
                            <!-- Small scattered gum pieces -->
                            <circle cx="20" cy="25" r="2" fill="#ffb3d9" opacity="0.6"/>
                            <circle cx="80" cy="30" r="1.5" fill="#ffb3d9" opacity="0.5"/>
                            <circle cx="15" cy="70" r="1.2" fill="#ffb3d9" opacity="0.4"/>
                        </svg>`;
                    break;
                    
                case 50: // Plastic straws - Bundle of colorful plastic straws
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <!-- Multiple plastic straws in different colors -->
                            <rect x="25" y="20" width="4" height="60" fill="#ff69b4" stroke="#e6578a" stroke-width="1" rx="2"/>
                            <rect x="32" y="18" width="4" height="64" fill="#4169e1" stroke="#2c5aa0" stroke-width="1" rx="2"/>
                            <rect x="39" y="22" width="4" height="56" fill="#32cd32" stroke="#228b22" stroke-width="1" rx="2"/>
                            <rect x="46" y="20" width="4" height="60" fill="#ffd700" stroke="#daa520" stroke-width="1" rx="2"/>
                            <rect x="53" y="19" width="4" height="62" fill="#ff4500" stroke="#cc3300" stroke-width="1" rx="2"/>
                            <rect x="60" y="21" width="4" height="58" fill="#9932cc" stroke="#7b1fa2" stroke-width="1" rx="2"/>
                            <rect x="67" y="20" width="4" height="60" fill="#ff1493" stroke="#cc1070" stroke-width="1" rx="2"/>
                            
                            <!-- Bendy sections for some straws -->
                            <g stroke-width="0.5" fill="none">
                                <line x1="27" y1="35" x2="27" y2="37" stroke="#ff69b4"/>
                                <line x1="27" y1="39" x2="27" y2="41" stroke="#ff69b4"/>
                                <line x1="34" y1="40" x2="34" y2="42" stroke="#4169e1"/>
                                <line x1="34" y1="44" x2="34" y2="46" stroke="#4169e1"/>
                                <line x1="48" y1="38" x2="48" y2="40" stroke="#ffd700"/>
                                <line x1="48" y1="42" x2="48" y2="44" stroke="#ffd700"/>
                                <line x1="55" y1="36" x2="55" y2="38" stroke="#ff4500"/>
                                <line x1="55" y1="40" x2="55" y2="42" stroke="#ff4500"/>
                                <line x1="69" y1="37" x2="69" y2="39" stroke="#ff1493"/>
                                <line x1="69" y1="41" x2="69" y2="43" stroke="#ff1493"/>
                            </g>
                            
                            <!-- Highlights on straws -->
                            <rect x="26" y="25" width="1" height="50" fill="#ffffff" opacity="0.6"/>
                            <rect x="33" y="23" width="1" height="54" fill="#ffffff" opacity="0.6"/>
                            <rect x="40" y="27" width="1" height="46" fill="#ffffff" opacity="0.6"/>
                            <rect x="47" y="25" width="1" height="50" fill="#ffffff" opacity="0.6"/>
                            <rect x="54" y="24" width="1" height="52" fill="#ffffff" opacity="0.6"/>
                            <rect x="61" y="26" width="1" height="48" fill="#ffffff" opacity="0.6"/>
                            <rect x="68" y="25" width="1" height="50" fill="#ffffff" opacity="0.6"/>
                            
                            <!-- Warning label -->
                            <rect x="10" y="85" width="80" height="10" fill="#fef2f2" stroke="#dc2626" stroke-width="1" rx="5"/>
                            <text x="50" y="92" text-anchor="middle" font-size="6" fill="#dc2626" font-weight="bold">PLASTIC STRAWS - TOO SMALL TO RECYCLE</text>
                        </svg>`;
                    break;
                    
                case 51: // Condiment packets - 3 rectangular packets (ketchup, mustard, mayo)
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <!-- Mustard packet (back left) -->
                            <rect x="15" y="25" width="35" height="45" fill="#fbbf24" stroke="#f59e0b" stroke-width="2" rx="4" opacity="0.8"/>
                            <rect x="20" y="35" width="25" height="15" fill="#ffffff" stroke="#e5e7eb" stroke-width="1" rx="2"/>
                            <text x="32.5" y="41" text-anchor="middle" font-size="4" fill="#f59e0b" font-weight="bold">FRENCH'S</text>
                            <text x="32.5" y="46" text-anchor="middle" font-size="3" fill="#f59e0b" font-weight="bold">MUSTARD</text>
                            
                            <!-- Mayo packet (back right) -->
                            <rect x="35" y="20" width="35" height="45" fill="#f8fafc" stroke="#cbd5e1" stroke-width="2" rx="4" opacity="0.8"/>
                            <rect x="40" y="30" width="25" height="15" fill="#1e40af" stroke="#1d4ed8" stroke-width="1" rx="2"/>
                            <text x="52.5" y="36" text-anchor="middle" font-size="4" fill="white" font-weight="bold">HELLMANN'S</text>
                            <text x="52.5" y="41" text-anchor="middle" font-size="3" fill="white" font-weight="bold">MAYO</text>
                            
                            <!-- Ketchup packet (front center, main) -->
                            <rect x="25" y="30" width="35" height="45" fill="#dc2626" stroke="#b91c1c" stroke-width="2" rx="4"/>
                            <rect x="30" y="40" width="25" height="15" fill="#ffffff" stroke="#e5e7eb" stroke-width="1" rx="2"/>
                            <text x="42.5" y="46" text-anchor="middle" font-size="4" fill="#dc2626" font-weight="bold">HEINZ</text>
                            <text x="42.5" y="51" text-anchor="middle" font-size="3" fill="#dc2626" font-weight="bold">KETCHUP</text>
                            
                            <!-- Crinkled edges for texture -->
                            <line x1="25" y1="45" x2="60" y2="45" stroke="#b91c1c" stroke-width="0.5" opacity="0.5"/>
                            <line x1="25" y1="65" x2="60" y2="65" stroke="#b91c1c" stroke-width="0.5" opacity="0.5"/>
                            <line x1="15" y1="50" x2="50" y2="50" stroke="#f59e0b" stroke-width="0.5" opacity="0.5"/>
                            <line x1="35" y1="40" x2="70" y2="40" stroke="#cbd5e1" stroke-width="0.5" opacity="0.5"/>
                            
                            <!-- Warning label -->
                            <rect x="10" y="85" width="80" height="10" fill="#fef2f2" stroke="#dc2626" stroke-width="1" rx="5"/>
                            <text x="50" y="92" text-anchor="middle" font-size="4" fill="#dc2626" font-weight="bold">CONDIMENT PACKETS</text>
                        </svg>`;
                    break;
                    
                case 52: // Foil drink pouch (Sunkist/Capri Sun) - Thinner metallic foil pouch with straw
                    svgContent = `
                        <svg width="${svgSize}" height="${svgSize}" viewBox="0 0 100 100">
                            <path d="M25 25 Q23 20 27 20 L73 20 Q77 20 75 25 L80 70 Q80 80 70 80 L30 80 Q20 80 20 70 Z" 
                                  fill="#c0c0c0" stroke="#a0a0a0" stroke-width="2"/>
                            <rect x="30" y="30" width="40" height="20" fill="#ff6b35" stroke="#cc4125" stroke-width="2" rx="3"/>
                            <text x="50" y="38" text-anchor="middle" font-size="7" fill="white" font-weight="bold">SUNKIST</text>
                            <text x="50" y="46" text-anchor="middle" font-size="5" fill="white" font-weight="bold">ORANGE</text>
                            <ellipse cx="50" cy="60" rx="15" ry="8" fill="#ffcc00" opacity="0.8"/>
                            <circle cx="45" cy="58" r="2.5" fill="#ff8c00" opacity="0.9"/>
                            <circle cx="55" cy="62" r="2" fill="#ff8c00" opacity="0.9"/>
                            <circle cx="50" cy="65" r="1.5" fill="#ff8c00" opacity="0.8"/>
                            <path d="M25 25 L35 30 L40 25 L50 30 L55 25 L60 30 L70 25 L75 30" 
                                  stroke="#d4d4d8" stroke-width="1" fill="none"/>
                            <path d="M20 70 L30 65 L40 70 L50 65 L60 70 L70 65 L80 70" 
                                  stroke="#d4d4d8" stroke-width="1" fill="none"/>
                            <rect x="20" y="15" width="60" height="4" fill="#e5e7eb" stroke="#d1d5db" stroke-width="1" rx="2"/>
                            <text x="50" y="17" text-anchor="middle" font-size="3" fill="#666" font-weight="bold">FOIL POUCH</text>
                            <ellipse cx="35" cy="35" rx="2" ry="1" fill="#ffffff" opacity="0.6"/>
                            <ellipse cx="65" cy="40" rx="1.5" ry="0.8" fill="#ffffff" opacity="0.6"/>
                            <!-- Straw inserted in the pouch -->
                            <rect x="58" y="20" width="3" height="25" fill="#ffff00" stroke="#e6e600" stroke-width="1" rx="1"/>
                            <rect x="56" y="18" width="7" height="4" fill="#ffff00" stroke="#e6e600" stroke-width="1" rx="2"/>
                            <circle cx="59.5" cy="22" r="1" fill="#ffffff" opacity="0.8"/>
                        </svg>`;
                    break;
                    
                default:
                    return null;
            }
            
            return svgContent;
        }

        // Initialize game
        function initGame() {
            updateUI();
            showLevelLesson();
            updateBackground();
            setupEventListeners();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Start/skip buttons
            document.getElementById('start-btn').addEventListener('click', hideLevelLesson);
            document.getElementById('skip-btn').addEventListener('click', function() {
                if (gameState.reviewMode) {
                    skipReview();
                } else {
                    hideLevelLesson();
                }
            });
            
            // Reset button
            document.getElementById('reset-btn').addEventListener('click', resetGame);
            
            // Play again button
            document.getElementById('play-again-btn').addEventListener('click', resetGame);
            
            // Drag and drop
            const currentItemEl = document.getElementById('current-item');
            currentItemEl.addEventListener('dragstart', handleDragStart);
            
            // Bins
            const bins = document.querySelectorAll('.bin');
            bins.forEach(bin => {
                bin.addEventListener('dragover', handleDragOver);
                bin.addEventListener('drop', handleDrop);
                bin.addEventListener('dragenter', handleDragEnter);
                bin.addEventListener('dragleave', handleDragLeave);
            });
        }

        // Update UI elements
        function updateUI() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('streak').textContent = gameState.streak;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('items-completed').textContent = gameState.itemsCompleted;
            
            // Update location message
            const messageData = locationMessages[gameState.level];
            const messageEl = document.getElementById('location-message');
            
            if (gameState.reviewMode) {
                const remainingItems = gameState.reviewItems.filter(item => 
                    gameState.wrongAnswers.has(item.id)
                ).length;
                messageEl.textContent = `📚 Review Mode: Practice your missed items! (${remainingItems} remaining)`;
                messageEl.className = 'location-message level-1'; // Use level-1 styling for review
            } else {
                messageEl.textContent = messageData.text;
                messageEl.className = `location-message ${messageData.class}`;
            }
        }

        // Update background based on level
        function updateBackground() {
            const background = document.getElementById('background');
            const backgroundSvg = document.getElementById('background-svg');
            
            // Ensure level is within valid range
            const level = Math.min(Math.max(gameState.level, 1), 3);
            
            background.className = `background level-${level}`;
            
            let svgContent = '';
            switch(level) {
                case 1:
                    svgContent = createLevel1Background();
                    break;
                case 2:
                    svgContent = createLevel2Background();
                    break;
                case 3:
                    svgContent = createLevel3Background();
                    break;
            }
            
            backgroundSvg.innerHTML = svgContent;
        }

        // Show level lesson modal
        function showLevelLesson() {
            const modal = document.getElementById('modal');
            const lesson = levelLessons[gameState.level];
            
            // Safety check - if no lesson exists for this level, complete the game
            if (!lesson) {
                showGameComplete();
                return;
            }
            
            document.getElementById('modal-title').textContent = lesson.title;
            document.getElementById('modal-subtitle').textContent = lesson.subtitle;
            
            let content = '';
            
            // Add location and environmental impact
            if (lesson.location && lesson.impact) {
                content += `
                    <div class="lesson-item" style="background: #dbeafe; border-left: 4px solid #3b82f6;">
                        <div class="lesson-bin">${lesson.location}</div>
                        <div class="lesson-description">${lesson.impact}</div>
                        <div class="lesson-tip">${lesson.pointsHelp}</div>
                    </div>
                `;
            }
            
            lesson.content.forEach(item => {
                content += `
                    <div class="lesson-item">
                        <div class="lesson-bin">${item.bin}</div>
                        <div class="lesson-description">${item.description}</div>
                        <div class="lesson-tip">${item.tip}</div>
                    </div>
                `;
            });
            
            if (lesson.commonMistakes) {
                content += `
                    <div class="lesson-warning">
                        <div class="warning-title">⚠️ Watch Out!</div>
                        <div class="warning-text">${lesson.commonMistakes}</div>
                    </div>
                `;
            }
            
            // Add hauler information
            if (lesson.haulerInfo) {
                content += `
                    <div class="lesson-item" style="background: #f0fdf4; border-left: 4px solid #16a34a;">
                        <div class="lesson-bin">${lesson.haulerInfo.title}</div>
                        <div class="lesson-description">${lesson.haulerInfo.description}</div>
                `;
                lesson.haulerInfo.companies.forEach(company => {
                    content += `<div class="lesson-tip">• <strong>${company.name}:</strong> ${company.service} (${company.website})</div>`;
                });
                content += '</div>';
            }
            
            document.getElementById('modal-body').innerHTML = content;
            
            const startBtn = document.getElementById('start-btn');
            const skipBtn = document.getElementById('skip-btn');
            
            startBtn.textContent = gameState.level === 1 ? 'Start Cleanup!' : 'Continue Cleanup!';
            skipBtn.classList.toggle('hidden', gameState.level === 1);
            
            modal.classList.remove('hidden');
        }

        // Get available items for current level or review
        function getAvailableItems() {
            if (gameState.reviewMode) {
                // In review mode, only show items that are still in wrongAnswers
                return gameState.reviewItems.filter(item => 
                    gameState.wrongAnswers.has(item.id)
                );
            } else {
                // Normal gameplay
                return wasteItems.filter(item => 
                    item.level <= gameState.level && 
                    !gameState.completedItems.has(item.id)
                );
            }
        }

        // Hide level lesson modal
        function hideLevelLesson() {
            document.getElementById('modal').classList.add('hidden');
            gameState.showingLesson = false;
            gameState.gameStarted = true;
            
            if (gameState.reviewMode) {
                // Starting review mode (could be regular or final review)
                gameState.completedItems = new Set(); // Reset completed items for review
            }
            
            getNextItem();
        }

        // Check if level 3 is complete and handle review before game completion
        function checkLevel3Complete() {
            // Hide current item first
            document.getElementById('current-item-container').classList.add('hidden');
            
            const wrongAnswersForLevel3 = Array.from(gameState.wrongAnswers).filter(id => {
                const item = wasteItems.find(item => item.id === id);
                return item && item.level <= 3; // All wrong answers from any level
            });
            
            if (wrongAnswersForLevel3.length > 0) {
                // Start final review mode before game completion
                startFinalReview(wrongAnswersForLevel3);
            } else {
                // No wrong answers, complete the game
                showGameComplete();
            }
        }

        // Start final review mode before game completion
        function startFinalReview(wrongItemIds) {
            gameState.reviewMode = true;
            gameState.reviewItems = wrongItemIds.map(id => wasteItems.find(item => item.id === id));
            gameState.completedItems = new Set(); // Reset for review
            
            showFinalReviewModal();
        }

        // Show final review modal for Level 3
        function showFinalReviewModal() {
            const modal = document.getElementById('modal');
            const wrongCount = gameState.reviewItems.length;
            
            document.getElementById('modal-title').textContent = 'Final Review Time!';
            document.getElementById('modal-subtitle').textContent = `Perfect your Seattle waste sorting skills with ${wrongCount} items you missed`;
            
            let content = `
                <div class="lesson-warning">
                    <div class="warning-title">🎯 Final Challenge!</div>
                    <div class="warning-text">You got ${wrongCount} items wrong during the game. Let's practice them one more time to become a true Seattle EcoSort expert!</div>
                </div>
                <div class="lesson-item">
                    <div class="lesson-bin">🌟 Master Challenge</div>
                    <div class="lesson-description">You'll only see the items you missed throughout all levels. Get them all right to achieve perfect mastery!</div>
                    <div class="lesson-tip">💡 Remember what you learned from the feedback and take your time.</div>
                </div>
                <div class="lesson-item" style="background: #f0fdf4;">
                    <div class="lesson-bin">⏭️ Your Choice</div>
                    <div class="lesson-description">You can perfect your skills by practicing your mistakes, or skip to see your final results.</div>
                    <div class="lesson-tip">🏆 Mastering your mistakes will make you a certified Seattle waste sorting expert!</div>
                </div>
            `;
            
            document.getElementById('modal-body').innerHTML = content;
            
            const startBtn = document.getElementById('start-btn');
            const skipBtn = document.getElementById('skip-btn');
            
            startBtn.textContent = 'Perfect My Skills!';
            skipBtn.textContent = 'Skip to Results';
            skipBtn.classList.remove('hidden');
            
            modal.classList.remove('hidden');
        }

        // Check if final review is complete
        function checkFinalReviewComplete() {
            const remainingWrongAnswers = gameState.reviewItems.filter(item => 
                gameState.wrongAnswers.has(item.id)
            );
            
            if (remainingWrongAnswers.length === 0) {
                // All review items corrected!
                gameState.reviewMode = false;
                gameState.reviewItems = [];
                
                // Hide current item
                document.getElementById('current-item-container').classList.add('hidden');
                
                showFeedback('success', 'Perfect! You\'ve mastered all Seattle waste sorting rules! 🌟', 0);
                
                setTimeout(() => {
                    hideFeedback();
                    showGameComplete();
                }, 3000);
            } else {
                // Still have items to review, get the next one
                getNextItem();
            }
        }

        // Check if level is complete and handle review
        function checkLevelComplete() {
            // Hide current item first
            document.getElementById('current-item-container').classList.add('hidden');
            
            const wrongAnswersForThisLevel = Array.from(gameState.wrongAnswers).filter(id => {
                const item = wasteItems.find(item => item.id === id);
                return item && item.level <= gameState.level;
            });
            
            if (wrongAnswersForThisLevel.length > 0) {
                // Start review mode
                startReview(wrongAnswersForThisLevel);
            } else {
                // No wrong answers, advance to next level
                levelUp();
            }
        }

        // Start review mode
        function startReview(wrongItemIds) {
            gameState.reviewMode = true;
            gameState.reviewItems = wrongItemIds.map(id => wasteItems.find(item => item.id === id));
            gameState.completedItems = new Set(); // Reset for review
            
            showReviewModal();
        }

        // Check if review is complete
        function checkReviewComplete() {
            const remainingWrongAnswers = gameState.reviewItems.filter(item => 
                gameState.wrongAnswers.has(item.id)
            );
            
            if (remainingWrongAnswers.length === 0) {
                // All review items corrected!
                gameState.reviewMode = false;
                gameState.reviewItems = [];
                
                // Hide current item
                document.getElementById('current-item-container').classList.add('hidden');
                
                showFeedback('success', 'Excellent! You\'ve corrected all your mistakes! 🎉', 0);
                
                setTimeout(() => {
                    hideFeedback();
                    levelUp();
                }, 3000);
            } else {
                // Still have items to review, get the next one
                getNextItem();
            }
        }

        // Show review modal
        function showReviewModal() {
            const modal = document.getElementById('modal');
            const wrongCount = gameState.reviewItems.length;
            
            document.getElementById('modal-title').textContent = 'Level Review Time!';
            document.getElementById('modal-subtitle').textContent = `Let's practice the ${wrongCount} items you missed`;
            
            let content = `
                <div class="lesson-warning">
                    <div class="warning-title">📚 Learning Opportunity!</div>
                    <div class="warning-text">You got ${wrongCount} items wrong this level. Let's practice them again to make sure you understand Seattle's sorting rules!</div>
                </div>
                <div class="lesson-item">
                    <div class="lesson-bin">🎯 Review Challenge</div>
                    <div class="lesson-description">You'll only see the items you missed. Keep trying each item until you get it right!</div>
                    <div class="lesson-tip">💡 Take your time and remember what you learned from the feedback.</div>
                </div>
                <div class="lesson-item" style="background: #f0fdf4;">
                    <div class="lesson-bin">⏭️ Your Choice</div>
                    <div class="lesson-description">You can practice your mistakes to master the rules, or skip review and move to the next level.</div>
                    <div class="lesson-tip">🌟 Practicing mistakes helps you become a true Seattle waste sorting expert!</div>
                </div>
            `;
            
            document.getElementById('modal-body').innerHTML = content;
            
            const startBtn = document.getElementById('start-btn');
            const skipBtn = document.getElementById('skip-btn');
            
            startBtn.textContent = 'Practice Mistakes!';
            skipBtn.textContent = 'Skip to Next Level';
            skipBtn.classList.remove('hidden');
            
            modal.classList.remove('hidden');
        }

        // Skip review and go directly to next level or game completion
        function skipReview() {
            gameState.reviewMode = false;
            gameState.reviewItems = [];
            gameState.wrongAnswers.clear();
            document.getElementById('modal').classList.add('hidden');
            
            // Hide current item
            document.getElementById('current-item-container').classList.add('hidden');
            
            // Check if this is final review or regular level review
            if (gameState.level >= 3 && gameState.itemsCompleted >= 49) {
                // Skip final review - go to game completion
                showFeedback('success', 'Moving to final results! 🎉', 0);
                
                setTimeout(() => {
                    hideFeedback();
                    showGameComplete();
                }, 2000);
            } else {
                // Skip regular level review - go to next level
                showFeedback('success', 'Moving to next level! 🚀', 0);
                
                setTimeout(() => {
                    hideFeedback();
                    levelUp();
                }, 2000);
            }
        }

        // Get next random item
        function getNextItem() {
            const availableItems = getAvailableItems();
            
            if (availableItems.length === 0) {
                // No more items available - game should be complete
                if (!gameState.reviewMode && gameState.itemsCompleted >= 49) {
                    showGameComplete();
                } else if (gameState.reviewMode) {
                    // All review items completed
                    checkReviewComplete();
                } else {
                    // This shouldn't happen, but if it does, complete the game
                    showGameComplete();
                }
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * availableItems.length);
            gameState.currentItem = availableItems[randomIndex];
            showCurrentItem();
        }

        // Show current item
        function showCurrentItem() {
            if (!gameState.currentItem) return;
            
            const container = document.getElementById('current-item-container');
            const itemEl = document.getElementById('current-item');
            const nameEl = document.getElementById('item-name');
            
            // Check if we have a custom SVG for this item
            const svgEmoji = generateSVGEmoji(gameState.currentItem.id);
            if (svgEmoji) {
                itemEl.innerHTML = svgEmoji;
            } else {
                // Clear any previous SVG and show emoji
                itemEl.innerHTML = '';
                itemEl.textContent = gameState.currentItem.emoji;
            }
            
            // Ensure drag functionality is working - re-attach event listener
            itemEl.draggable = true;
            itemEl.removeEventListener('dragstart', handleDragStart);
            itemEl.addEventListener('dragstart', handleDragStart);
            
            nameEl.textContent = gameState.currentItem.name;
            
            container.classList.remove('hidden');
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            this.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            if (!gameState.currentItem) return;
            
            const binType = this.getAttribute('data-type');
            
            // Check if the item can go in multiple bins (like shredded paper)
            let isCorrect = false;
            if (Array.isArray(gameState.currentItem.type)) {
                // Item can go in multiple bins
                isCorrect = gameState.currentItem.type.includes(binType);
            } else {
                // Item has only one correct bin
                isCorrect = gameState.currentItem.type === binType;
            }
            
            if (isCorrect) {
                const points = Math.round(10 * (1 + gameState.streak * 0.5));
                gameState.score += points;
                gameState.streak++;
                showFeedback('success', gameState.currentItem.explanation, points);
                
                // Mark item as completed and remove from wrong answers if in review mode
                gameState.completedItems.add(gameState.currentItem.id);
                if (gameState.reviewMode) {
                    gameState.wrongAnswers.delete(gameState.currentItem.id);
                }
                
                // Only increment items completed in normal mode
                if (!gameState.reviewMode) {
                    gameState.itemsCompleted++;
                }
            } else {
                gameState.streak = 0;
                showFeedback('error', gameState.currentItem.wrongExplanation, 0);
                
                // Track wrong answers only in normal mode
                if (!gameState.reviewMode) {
                    gameState.wrongAnswers.add(gameState.currentItem.id);
                    gameState.completedItems.add(gameState.currentItem.id);
                    gameState.itemsCompleted++;
                } else {
                    // In review mode, don't mark as completed if wrong - let them try again
                    showFeedback('error', gameState.currentItem.wrongExplanation + ' Try again!', 0);
                }
            }
            
            updateUI();
            
            // Hide current item immediately
            document.getElementById('current-item-container').classList.add('hidden');
            
            // Check for level completion or review completion
            const levelCompleteAt = gameState.level === 1 ? 16 : gameState.level === 2 ? 34 : 49;
            
            if (gameState.reviewMode) {
                // Check if review is complete - use appropriate function based on level
                setTimeout(() => {
                    hideFeedback();
                    if (gameState.level >= 3 && gameState.itemsCompleted >= 49) {
                        checkFinalReviewComplete();
                    } else {
                        checkReviewComplete();
                    }
                }, 2500);
            } else if (gameState.itemsCompleted >= 49) {
                // Level 3 complete - check for mistakes before finishing game
                gameState.showingLesson = true; // Prevent new items immediately
                setTimeout(() => {
                    hideFeedback();
                    checkLevel3Complete();
                }, 2500);
            } else if (gameState.itemsCompleted === levelCompleteAt) {
                // Level complete - start level up sequence
                gameState.showingLesson = true; // Prevent new items immediately
                setTimeout(() => {
                    hideFeedback();
                    checkLevelComplete();
                }, 2500);
            } else {
                // Continue with current level
                setTimeout(() => {
                    hideFeedback();
                    if (!gameState.showingLesson) {
                        getNextItem();
                    }
                }, 2500);
            }
        }

        // Show feedback with occasional environmental impact
        function showFeedback(type, message, points) {
            const feedback = document.getElementById('feedback');
            const icon = document.getElementById('feedback-icon');
            const title = document.getElementById('feedback-title');
            const messageEl = document.getElementById('feedback-message');
            const pointsEl = document.getElementById('feedback-points');
            
            feedback.className = `feedback ${type}`;
            icon.textContent = type === 'success' ? '✅' : '❌';
            title.textContent = type === 'success' ? 'Correct!' : 'Incorrect!';
            
            // Add environmental impact message occasionally for correct answers
            let displayMessage = message;
            if (type === 'success' && points > 0 && Math.random() < 0.3) { // 30% chance
                const locationData = locationMessages[gameState.level];
                const impactMessages = {
                    1: "🏭 Great job! You're helping keep Gas Works Park's historic grounds clean and safe!",
                    2: "🌊 Excellent! You're protecting Lake Union's marine life and water quality!",
                    3: "✨ Perfect! You're keeping Seattle Center beautiful for millions of visitors!"
                };
                displayMessage += ` ${impactMessages[gameState.level]}`;
            }
            
            messageEl.textContent = displayMessage;
            
            if (type === 'success' && points > 0) {
                pointsEl.textContent = `+${points} points!`;
                pointsEl.classList.remove('hidden');
            } else {
                pointsEl.classList.add('hidden');
            }
            
            feedback.classList.remove('hidden');
        }

        // Hide feedback
        function hideFeedback() {
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('level-up').classList.add('hidden');
        }

        // Level up
        function levelUp() {
            // Check if we've completed all levels
            if (gameState.level >= 3) {
                showGameComplete();
                return;
            }
            
            gameState.level++;
            gameState.showingLesson = true;
            
            // Show level up message
            const levelUpEl = document.getElementById('level-up');
            levelUpEl.textContent = `🎉 Level Up! Welcome to Level ${gameState.level}! 🎉`;
            levelUpEl.classList.remove('hidden');
            
            updateBackground();
            
            setTimeout(() => {
                hideFeedback();
                showLevelLesson();
            }, 3000);
        }

        // Show game complete with environmental impact summary
        function showGameComplete() {
            const feedback = document.getElementById('feedback');
            const icon = document.getElementById('feedback-icon');
            const title = document.getElementById('feedback-title');
            const messageEl = document.getElementById('feedback-message');
            const gameCompleteEl = document.getElementById('game-complete');
            const finalScoreEl = document.getElementById('final-score');
            
            feedback.className = 'feedback success';
            icon.textContent = '🎉';
            title.textContent = 'Seattle Cleanup Complete!';
            
            // Calculate environmental impact
            const itemsCleaned = Math.floor(gameState.score / 10);
            const masteryText = gameState.wrongAnswers.size === 0 ? 
                "Perfect mastery achieved! " : 
                "Great job! ";
                
            const impactMessage = `${masteryText}You've completed Seattle waste sorting with all 49 items! 
            
            🌍 Your Environmental Impact:
            • Gas Works Park: ${Math.floor(itemsCleaned * 0.33)} pieces of litter removed
            • Lake Union: ${Math.floor(itemsCleaned * 0.33)} pieces prevented from entering water
            • Seattle Center: ${Math.floor(itemsCleaned * 0.34)} areas kept pristine
            
            You're now a certified Seattle EcoSort expert! 🌱`;
            
            messageEl.textContent = impactMessage;
            
            finalScoreEl.textContent = gameState.score;
            gameCompleteEl.classList.remove('hidden');
            feedback.classList.remove('hidden');
        }

        // Reset game
        function resetGame() {
            gameState = {
                score: 0,
                streak: 0,
                level: 1,
                itemsCompleted: 0,
                currentItem: null,
                completedItems: new Set(),
                wrongAnswers: new Set(),
                gameStarted: false,
                showingLesson: true,
                reviewMode: false,
                reviewItems: []
            };
            
            hideFeedback();
            document.getElementById('current-item-container').classList.add('hidden');
            document.getElementById('game-complete').classList.add('hidden');
            
            updateUI();
            updateBackground();
            showLevelLesson();
        }

        // Start the game when page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
